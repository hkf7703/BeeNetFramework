var bee={keyCode:{ENTER:13,ESC:27,END:35,HOME:36,SHIFT:16,TAB:9,LEFT:37,RIGHT:39,UP:38,DOWN:40,DELETE:46,BACKSPACE:8},ui:{sbar:true},frag:{},_msg:{},jsonEval:function(json){try{if($.type(json)=="string"){return eval("("+json+")")}else{return json}}catch(e){return{}}},_set:{loginUrl:"",loginTitle:"",debug:true},debug:function(a){if(this._set.debug){if(typeof(console)!="undefined"){console.log(a)}else{alert(a)}}},msg:function(c,b){var a=function(g,e){e=e||[];var d=g||"";for(var f=0;f<e.length;f++){d=d.replace(new RegExp("\\{"+f+"\\}","g"),e[f])}return d};return a(this._msg[c],b)},ajaxError:function(c,a,b){if(alertMsg){alertMsg.error("<div>Http status: "+c.status+" "+c.statusText+"</div><div>ajaxOptions: "+a+"</div><div>thrownError: "+b+"</div><div>"+c.responseText+"</div>")}else{alert("Http status: "+c.status+" "+c.statusText+"\najaxOptions: "+a+"\nthrownError:"+b+"\n"+c.responseText)}},ajaxDone:function(a){if(a.status){if(a.message&&alertMsg){alertMsg.correct(a.message)}}else{if(a.message&&alertMsg){alertMsg.error(a.message)}}},isOverAxis:function(b,a,c){return(b>a)&&(b<(a+c))},isOver:function(f,b,e,d,a,c){return this.isOverAxis(f,e,a)&&this.isOverAxis(b,d,c)},init:function(a){var b=$.extend({callback:null,debug:false},a);jQuery.ajax({type:"GET",url:"/js/bee.html.xml",dataType:"xml",timeout:50000,cache:false,error:function(c){alert("Error loading XML document: "+pageFrag+"\nHttp status: "+c.status+" "+c.statusText)},success:function(c){$(c).find("_PAGE_").each(function(){var d=$(this).attr("id");if(d){bee.frag[d]=$(this).text()}});$(c).find("_MSG_").each(function(){var d=$(this).attr("id");if(d){bee._msg[d]=$(this).text()}});if(jQuery.isFunction(b.callback)){b.callback()}}});$(":text.number").live("change",function(){var e=$(this);var d=e.attr("format");var c=e.val();if(c.indexOf(".")>0){if(d=="none"){return}if(d==undefined){d=2}e.val(e.val().formatNumber(d))}})},PostData:function(service,para,successFunction,options){var $callback=successFunction;if(!$.isFunction($callback)){$callback=eval("("+successFunction+")")}var isGlobal=false;if(options){isGlobal=options.global}$.ajax({type:"post",url:service,data:para,global:isGlobal,dataType:"json",success:function(json){if(!json.status){if(json.message&&alertMsg){alertMsg.error(json.message)}if(json.tologin){toLogin()}}else{if($.isFunction($callback)){$callback(json.result)}}},error:bee.ajaxError})},initUI:function(_box){var $p=$(_box||document);if($.fn.jPanel){$("div.panel",$p).jPanel()}if($.fn.widget){$("div.widget",$p).each(function(){var $this=$(this);$this.widget({collapsible:!$this.hasClass("noCollape"),removable:!$this.hasClass("noRemove")})})}$("div.accordion",$p).each(function(){var $this=$(this);$this.accordion({fillSpace:$this.attr("fillSpace"),alwaysOpen:false,active:0})});if($.fn.jTable){$("table.table",$p).jTable()}if($.fn.cssTable){$("table.list",$p).cssTable()}if($.fn.tabs){$("div.tabs",$p).each(function(){var $this=$(this);var options={};options.currentIndex=$this.attr("currentIndex")||0;options.eventType=$this.attr("eventType")||"click";$this.tabs(options)})}if($.fn.jBar){$("#leftside",$p).jBar({minW:150,maxW:700})}if($.fn.jTree){$("ul.tree",$p).jTree()}$("input[type=text], input[type=password], textarea",$p).addClass("textInput").focusClass("focus");$("input[readonly], textarea[readonly]",$p).addClass("readonly");$("input[disabled=true], textarea[disabled=true]",$p).addClass("disabled");$("form",$p).keypress(function(event){if(event.keyCode==bee.keyCode.ENTER){return false}});if($.fn.combox){$("select.combox",$p).combox()}if($.fn.jtip){$(".tip",$p).jtip()}if($.fn.checkboxCtrl){$(":button.checkboxCtrl, :checkbox.checkboxCtrl",$p).checkboxCtrl($p)}if($.fn.datepicker){$("input.date",$p).each(function(){var $this=$(this);var opts={};if($this.attr("dateFmt")){opts.pattern=$this.attr("dateFmt")}if($this.attr("minDate")){opts.minDate=$this.attr("minDate")}if($this.attr("maxDate")){opts.maxDate=$this.attr("maxDate")}if($this.attr("mmStep")){opts.mmStep=$this.attr("mmStep")}if($this.attr("ssStep")){opts.ssStep=$this.attr("ssStep")}$this.datepicker(opts)})}$("form.required-validate",$p).each(function(){var $form=$(this);$form.validate({focusInvalid:false,focusCleanup:true,errorElement:"span",ignore:".ignore",showErrors:function(){var idValue=$form.attr("id");if($form.hasClass("alertMsg")){validShowAlertMsgError(this)}else{this.defaultShowErrors()}}})});if(navTab){navTab.init()}$("div.pagination",$p).each(function(){var $this=$(this);$this.pagination({targetType:$this.attr("targetType"),totalCount:$this.attr("totalCount"),numPerPage:$this.attr("numPerPage"),pageNumShown:$this.attr("pageNumShown"),currentPage:$this.attr("currentPage"),href:$this.attr("href"),click:$this.attr("click")})});$("a[target=navTab]",$p).each(function(){$(this).click(function(event){var $this=$(this);var title=$this.attr("title")||$this.text();var tabid=$this.attr("rel")||"_blank";var fresh=eval($this.attr("fresh")||"true");var external=eval($this.attr("external")||"false");var url=unescape($this.attr("href"));if(!url.isFinishedTm()){alertMsg.error($this.attr("warn"));return false}navTab.openTab(tabid,url,{title:title,fresh:fresh,external:external});event.preventDefault()})});$("a[target=bdialog]",$p).each(function(){$(this).click(function(event){var $this=$(this);var title=$this.attr("title")||$this.text();var w=$this.attr("width");var h=$this.attr("height");var url=unescape($this.attr("href")).replaceTmById($p);if(!url.isFinishedTm()){alertMsg.error($this.attr("warn"));return false}if(!w){w=800}if(!h){h=600}event.preventDefault();window.open(url,title,"height="+h+",width="+w+",top=100,left=150,toolbar=no,menubar=no,scrollbars=yes,resizable=yes, location=no,status=no")})});if($.fn.jtip){$("a[target=tip],a[target=imgtip]",$p).each(function(){$(this).attr("title","");$(this).jtip();$(this).click(function(event){event.preventDefault()})})}$("a[target=dialog]",$p).each(function(){$(this).click(function(event){var $this=$(this);var title=$this.attr("title")||$this.text();var rel=$this.attr("rel")||"_blank";var options={};var w=$this.attr("width");var h=$this.attr("height");if(w){options.width=w}if(h){options.height=h}options.max=eval($this.attr("max")||"false");options.mask=eval($this.attr("mask")||"false");options.maxable=eval($this.attr("maxable")||"false");options.minable=eval($this.attr("minable")||"false");options.fresh=eval($this.attr("fresh")||"true");options.resizable=eval($this.attr("resizable")||"true");options.drawable=eval($this.attr("drawable")||"true");options.close=eval($this.attr("close")||"");options.param=$this.attr("param")||"";var url=unescape($this.attr("href")).replaceTmById($p);if(!url.isFinishedTm()){alertMsg.error($this.attr("warn"));return false}$.pdialog.open(url,rel,title,options);return false})});$("a[target=ajaxTodo]",$p).each(function(){$(this).click(function(event){var $this=$(this);var url=unescape($this.attr("href")).replaceTmById($p);var title=$this.attr("title");if(title){alertMsg.confirm(title,{okCall:function(){ajaxTodo(url,$this.attr("callback"))}})}else{ajaxTodo(url,$this.attr("callback"))}event.preventDefault()})});if($.fn.uploadify){$(":file[uploaderOption]",$p).each(function(){var $this=$(this);var options={fileObjName:$this.attr("name")||"file",auto:true,multi:true,onUploadError:uploadifyError};var uploaderOption=bee.jsonEval($this.attr("uploaderOption"));$.extend(options,uploaderOption);$this.uploadify(options)})}if($.fn.tagsInput){$("input[tagsInputOption]",$p).each(function(){var $this=$(this);var options={defaultText:"添加标签"};var uploaderOption=bee.jsonEval($this.attr("tagsInputOption"));$.extend(options,uploaderOption);$this.tagsInput(options)})}if($.fn.xheditor){$("textarea.editor",$p).each(function(){var $this=$(this);var op={html5Upload:false,skin:"vista",tools:$this.attr("tools")||"full"};var upAttrs=[["upLinkUrl","upLinkExt","zip,rar,txt"],["upImgUrl","upImgExt","jpg,jpeg,gif,png"],["upFlashUrl","upFlashExt","swf"],["upMediaUrl","upMediaExt","avi"]];$(upAttrs).each(function(i){var urlAttr=upAttrs[i][0];var extAttr=upAttrs[i][1];if($this.attr(urlAttr)){op[urlAttr]=$this.attr(urlAttr);op[extAttr]=$this.attr(extAttr)||upAttrs[i][2]}});$this.xheditor(op)})}if($.fn.sortDrag){$("div.sortDrag, ul.sortDrag",$p).sortDrag()}if($.fn.itemDetail){$("table.itemDetail",$p).itemDetail()}if($.fn.suggest){$("input[suggestFields]",$p).suggest()}if($.fn.lookup){$("a[lookupGroup]",$p).lookup()}if($.fn.multLookup){$("a[multLookup]",$p).multLookup()}}};if($.validator){$.extend($.validator.messages,{required:"必填字段",remote:"请修正该字段",email:"请输入正确格式的电子邮件",url:"请输入合法的网址",date:"请输入合法的日期",dateISO:"请输入合法的日期 (ISO).",number:"请输入合法的数字",digits:"只能输入整数",creditcard:"请输入合法的信用卡号",equalTo:"请再次输入相同的值",accept:"请输入拥有合法后缀名的字符串",maxlength:$.validator.format("长度最多是 {0} 的字符串"),minlength:$.validator.format("长度最少是 {0} 的字符串"),rangelength:$.validator.format("长度介于 {0} 和 {1} 之间的字符串"),range:$.validator.format("请输入一个介于 {0} 和 {1} 之间的值"),max:$.validator.format("请输入一个最大为 {0} 的值"),min:$.validator.format("请输入一个最小为 {0} 的值"),alphanumeric:"字母、数字、下划线",lettersonly:"必须是字母",phone:"数字、空格、括号"})}(function(a){a.setRegional=function(b,c){if(!a.regional){a.regional={}}a.regional[b]=c};a.fn.extend({cookie:function(c,k,n){if(typeof k!="undefined"){n=n||{};if(k===null){k="";n.expires=-1}var f="";if(n.expires&&(typeof n.expires=="number"||n.expires.toUTCString)){var g;if(typeof n.expires=="number"){g=new Date();g.setTime(g.getTime()+(n.expires*24*60*60*1000))}else{g=n.expires}f="; expires="+g.toUTCString()}var m=n.path?"; path="+n.path:"";var h=n.domain?"; domain="+n.domain:"";var b=n.secure?"; secure":"";document.cookie=[c,"=",encodeURIComponent(k),f,m,h,b].join("")}else{var e=null;if(document.cookie&&document.cookie!=""){var l=document.cookie.split(";");for(var j=0;j<l.length;j++){var d=jQuery.trim(l[j]);if(d.substring(0,c.length+1)==(c+"=")){e=decodeURIComponent(d.substring(c.length+1));break}}}return e}},ajaxUrl:function(c){var b=a(this);a.ajax({type:c.type||"GET",url:c.url,data:c.data,cache:false,success:function(d){var e=bee.jsonEval(d);if(e.status!=undefined){if(!e.status){alertMsg.error(e.message);if(e.tologin){toLogin()}}else{b.html(e.result);bee.initUI(b)}}else{b.html(d);bee.initUI(b)}if(c.callback){if(a.isFunction(c.callback)){c.callback(d)}}},error:bee.ajaxError})},loadUrl:function(b,c,d){a(this).ajaxUrl({url:b,data:c,callback:d})},initUI:function(){return this.each(function(){bee.initUI(this)})},layoutH:function(b){return this.each(function(){var e=a(this);if(!b){b=("dialog"==e.attr("layoutType")&&a.pdialog)?a.pdialog.getCurrent().find(".dialogContent"):a("#container .tabsPageContent")}var c=b.height();var f=parseInt(e.attr("layoutH"));var d=c-f>50?c-f:50;if(e.isTag("table")){e.removeAttr("layoutH").wrap('<div layoutH="'+f+'" style="overflow:auto;height:'+d+'px"></div>')}else{e.height(d).css("overflow","auto")}})},hoverClass:function(b){var c=b||"hover";return this.each(function(){a(this).hover(function(){a(this).addClass(c)},function(){a(this).removeClass(c)})})},focusClass:function(b){var c=b||"textInputFocus";return this.each(function(){a(this).focus(function(){a(this).addClass(c)}).blur(function(){a(this).removeClass(c)})})},inputAlert:function(){return this.each(function(){var d=a(this);function c(){return d.parent().find("label.alt")}function e(g){var f=d.position();return{width:d.width(),top:f.top+"px",left:f.left+"px",opacity:g||1}}if(c().size()<1){if(!d.attr("id")){d.attr("id",d.attr("name")+"_"+Math.round(Math.random()*10000))}var b=a('<label class="alt" for="'+d.attr("id")+'">'+d.attr("alt")+"</label>").appendTo(d.parent());b.css(e(1));if(d.val()){b.hide()}}d.focus(function(){c().css(e(0.3))}).blur(function(){if(!a(this).val()){c().show().css("opacity",1)}}).keydown(function(){c().hide()})})},isTag:function(b){if(!b){return false}return a(this)[0].tagName.toLowerCase()==b?true:false}});a.extend(String.prototype,{isPositiveInteger:function(){return(new RegExp(/^[1-9]\d*$/).test(this))},isInteger:function(){return(new RegExp(/^\d+$/).test(this))},isNumber:function(c,b){return(new RegExp(/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/).test(this))},trim:function(){return this.replace(/(^\s*)|(\s*$)|\r|\n/g,"")},compareIgnoreCase:function(b){return this.toLowerCase()==b.toLowerCase()},startsWith:function(b){return this.indexOf(b)===0},endsWith:function(b){var c=this.length-b.length;return c>=0&&this.lastIndexOf(b)===c},replaceSuffix:function(b){return this.replace(/\[[0-9]+\]/,"["+b+"]").replace("#index#",b)},trans:function(){return this.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},replaceForId:function(){return this.replace(new RegExp("([\\[\\]\\.]+?)","gm"),"\\$1")},replaceAll:function(c,b){return this.replace(new RegExp(c,"igm"),b)},replaceTm:function(b){if(!b){return this}return this.replace(RegExp("({[A-Za-z_]+[A-Za-z0-9_]*})","g"),function(c){return b[c.replace(/[{}]+/g,"")]})},replaceTmById:function(b){var c=b||a(document);return this.replace(RegExp("({[A-Za-z_]+[A-Za-z0-9_\\.\\[\\]]*})","g"),function(d){var e=d.replace(/[{}]+/g,"");e=e.replaceForId();var f=c.find("#"+e);if(f.length){return f.val()}else{f=c.find("input[name="+e+"], select[name="+e+"]");if(f.length){return f.val()}}return""})},isFinishedTm:function(){return !(new RegExp("{[A-Za-z_]+[A-Za-z0-9_]*}").test(this))},skipChar:function(b){if(!this||this.length===0){return""}if(this.charAt(0)===b){return this.substring(1).skipChar(b)}return this},isValidPwd:function(){return(new RegExp(/^([_]|[a-zA-Z0-9]){6,32}$/).test(this))},isValidMail:function(){return(new RegExp(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/).test(this.trim()))},isSpaces:function(){for(var b=0;b<this.length;b+=1){var c=this.charAt(b);if(c!=" "&&c!="\n"&&c!="\t"&&c!="\r"){return false}}return true},isPhone:function(){return(new RegExp(/(^([0-9]{3,4}[-])?\d{3,8}(-\d{1,6})?$)|(^\([0-9]{3,4}\)\d{3,8}(\(\d{1,6}\))?$)|(^\d{3,8}$)/).test(this))},isUrl:function(){return(new RegExp(/^[a-zA-z]+:\/\/([a-zA-Z0-9\-\.]+)([-\w .\/?%&=:]*)$/).test(this))},isExternalUrl:function(){return this.isUrl()&&this.indexOf("://"+document.domain)==-1},formatNumber:function(h){var d=parseInt(h);var f=(this+"").replace(/[^0-9+-Ee.]/g,"");var c=!isFinite(+f)?0:+f,b=!isFinite(+d)?0:Math.abs(d),k=(typeof thousands_sep==="undefined")?",":thousands_sep,e=(typeof dec_point==="undefined")?".":dec_point,j="",g=function(o,m){var l=Math.pow(10,m);return""+Math.round(o*l)/l};j=(b?g(c,b):""+Math.round(c)).split(".");if(j[0].length>3){j[0]=j[0].replace(/B(?=(?:d{3})+(?!d))/g,k)}if((j[1]||"").length<b){j[1]=j[1]||"";j[1]+=new Array(b-j[1].length+1).join("0")}return j.join(e)}})})(jQuery);function Map(){this.elements=new Array();this.size=function(){return this.elements.length};this.isEmpty=function(){return(this.elements.length<1)};this.clear=function(){this.elements=new Array()};this.put=function(b,a){this.remove(b);this.elements.push({key:b,value:a})};this.remove=function(a){try{for(i=0;i<this.elements.length;i++){if(this.elements[i].key==a){this.elements.splice(i,1);return true}}}catch(b){return false}return false};this.get=function(a){try{for(i=0;i<this.elements.length;i++){if(this.elements[i].key==a){return this.elements[i].value}}}catch(b){return null}};this.element=function(a){if(a<0||a>=this.elements.length){return null}return this.elements[a]};this.containsKey=function(a){try{for(i=0;i<this.elements.length;i++){if(this.elements[i].key==a){return true}}}catch(b){return false}return false};this.values=function(){var a=new Array();for(i=0;i<this.elements.length;i++){a.push(this.elements[i].value)}return a};this.keys=function(){var a=new Array();for(i=0;i<this.elements.length;i++){a.push(this.elements[i].key)}return a}}(function(){var MONTH_NAMES=new Array("January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");var DAY_NAMES=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat");function LZ(x){return(x<0||x>9?"":"0")+x}function formatDate(date,format){format=format+"";var result="";var i_format=0;var c="";var token="";var y=date.getYear()+"";var M=date.getMonth()+1;var d=date.getDate();var E=date.getDay();var H=date.getHours();var m=date.getMinutes();var s=date.getSeconds();var yyyy,yy,MMM,MM,dd,hh,h,mm,ss,ampm,HH,H,KK,K,kk,k;var value={};if(y.length<4){y=""+(y-0+1900)}value.y=""+y;value.yyyy=y;value.yy=y.substring(2,4);value.M=M;value.MM=LZ(M);value.MMM=MONTH_NAMES[M-1];value.NNN=MONTH_NAMES[M+11];value.d=d;value.dd=LZ(d);value.E=DAY_NAMES[E+7];value.EE=DAY_NAMES[E];value.H=H;value.HH=LZ(H);if(H==0){value.h=12}else{if(H>12){value.h=H-12}else{value.h=H}}value.hh=LZ(value.h);if(H>11){value.K=H-12}else{value.K=H}value.k=H+1;value.KK=LZ(value.K);value.kk=LZ(value.k);if(H>11){value.a="PM"}else{value.a="AM"}value.m=m;value.mm=LZ(m);value.s=s;value.ss=LZ(s);while(i_format<format.length){c=format.charAt(i_format);token="";while((format.charAt(i_format)==c)&&(i_format<format.length)){token+=format.charAt(i_format++)}if(value[token]!=null){result+=value[token]}else{result+=token}}return result}function _isInteger(val){return(new RegExp(/^\d+$/).test(val))}function _getInt(str,i,minlength,maxlength){for(var x=maxlength;x>=minlength;x--){var token=str.substring(i,i+x);if(token.length<minlength){return null}if(_isInteger(token)){return token}}return null}function parseDate(val,format){val=val+"";format=format+"";var i_val=0;var i_format=0;var c="";var token="";var token2="";var x,y;var now=new Date(1900,0,1);var year=now.getYear();var month=now.getMonth()+1;var date=1;var hh=now.getHours();var mm=now.getMinutes();var ss=now.getSeconds();var ampm="";while(i_format<format.length){c=format.charAt(i_format);token="";while((format.charAt(i_format)==c)&&(i_format<format.length)){token+=format.charAt(i_format++)}if(token=="yyyy"||token=="yy"||token=="y"){if(token=="yyyy"){x=4;y=4}if(token=="yy"){x=2;y=2}if(token=="y"){x=2;y=4}year=_getInt(val,i_val,x,y);if(year==null){return 0}i_val+=year.length;if(year.length==2){if(year>70){year=1900+(year-0)}else{year=2000+(year-0)}}}else{if(token=="MMM"||token=="NNN"){month=0;for(var i=0;i<MONTH_NAMES.length;i++){var month_name=MONTH_NAMES[i];if(val.substring(i_val,i_val+month_name.length).toLowerCase()==month_name.toLowerCase()){if(token=="MMM"||(token=="NNN"&&i>11)){month=i+1;if(month>12){month-=12}i_val+=month_name.length;break}}}if((month<1)||(month>12)){return 0}}else{if(token=="EE"||token=="E"){for(var i=0;i<DAY_NAMES.length;i++){var day_name=DAY_NAMES[i];if(val.substring(i_val,i_val+day_name.length).toLowerCase()==day_name.toLowerCase()){i_val+=day_name.length;break}}}else{if(token=="MM"||token=="M"){month=_getInt(val,i_val,token.length,2);if(month==null||(month<1)||(month>12)){return 0}i_val+=month.length}else{if(token=="dd"||token=="d"){date=_getInt(val,i_val,token.length,2);if(date==null||(date<1)||(date>31)){return 0}i_val+=date.length}else{if(token=="hh"||token=="h"){hh=_getInt(val,i_val,token.length,2);if(hh==null||(hh<1)||(hh>12)){return 0}i_val+=hh.length}else{if(token=="HH"||token=="H"){hh=_getInt(val,i_val,token.length,2);if(hh==null||(hh<0)||(hh>23)){return 0}i_val+=hh.length}else{if(token=="KK"||token=="K"){hh=_getInt(val,i_val,token.length,2);if(hh==null||(hh<0)||(hh>11)){return 0}i_val+=hh.length}else{if(token=="kk"||token=="k"){hh=_getInt(val,i_val,token.length,2);if(hh==null||(hh<1)||(hh>24)){return 0}i_val+=hh.length;hh--}else{if(token=="mm"||token=="m"){mm=_getInt(val,i_val,token.length,2);if(mm==null||(mm<0)||(mm>59)){return 0}i_val+=mm.length}else{if(token=="ss"||token=="s"){ss=_getInt(val,i_val,token.length,2);if(ss==null||(ss<0)||(ss>59)){return 0}i_val+=ss.length}else{if(token=="a"){if(val.substring(i_val,i_val+2).toLowerCase()=="am"){ampm="AM"}else{if(val.substring(i_val,i_val+2).toLowerCase()=="pm"){ampm="PM"}else{return 0}}i_val+=2}else{if(val.substring(i_val,i_val+token.length)!=token){return 0}else{i_val+=token.length}}}}}}}}}}}}}}if(i_val!=val.length){return 0}if(month==2){if(((year%4==0)&&(year%100!=0))||(year%400==0)){if(date>29){return 0}}else{if(date>28){return 0}}}if((month==4)||(month==6)||(month==9)||(month==11)){if(date>30){return 0}}if(hh<12&&ampm=="PM"){hh=hh-0+12}else{if(hh>11&&ampm=="AM"){hh-=12}}return new Date(year,month-1,date,hh,mm,ss)}Date.prototype.formatDate=function(dateFmt){return formatDate(this,dateFmt)};String.prototype.parseDate=function(dateFmt){if(this.length<dateFmt.length){dateFmt=dateFmt.slice(0,this.length)}return parseDate(this,dateFmt)};Date.prototype.getDays=function(){var y,m;y=this.getFullYear();m=this.getMonth()+1;return m==2?(y%4||!(y%100)&&y%400?28:29):(/4|6|9|11/.test(m)?30:31)};function replaceTmEval(data){return data.replace(RegExp("({[A-Za-z0-9_+-]*})","g"),function($1){return eval("("+$1.replace(/[{}]+/g,"")+")")})}Date.prototype.formatDateTm=function(dateFmt){var y=this.getFullYear();var m=this.getMonth()+1;var d=this.getDate();var sDate=dateFmt.replaceAll("%y",y).replaceAll("%M",m).replaceAll("%d",d);sDate=replaceTmEval(sDate);var _y=1900,_m=0,_d=1;var aDate=sDate.split("-");if(aDate.length>0){_y=aDate[0]}if(aDate.length>1){_m=aDate[1]-1}if(aDate.length>2){_d=aDate[2]}return new Date(_y,_m,_d).formatDate("yyyy-MM-dd")};String.prototype.IsValidDate=function(){try{if(this.length==10){return this.parseDate("yyyy-M-d")!=0}else{if(this.length==7){return this.parseDate("yyyy-M")!=0}else{return this.parseDate("yyyy")!=0}}}catch(e){return false}}})();(function(a){a.fn.jDrag=function(b){if(typeof b=="string"){if(b=="destroy"){return this.each(function(){a(this).unbind("mousedown",a.rwdrag.start);a.data(this,"pp-rwdrag",null)})}}return this.each(function(){var d=a(this);a.data(a.rwdrag,"pp-rwdrag",{options:a.extend({el:d,obj:d},b)});if(b.event){a.rwdrag.start(b.event)}else{var c=b.selector;a(c,obj).bind("mousedown",a.rwdrag.start)}})};a.rwdrag={start:function(d){var c=a.data(this,"pp-rwdrag");var b=c.options.el[0];a.data(b,"pp-rwdrag",{options:c.options});if(!a.rwdrag.current){a.rwdrag.current={el:b,oleft:parseInt(b.style.left)||0,otop:parseInt(b.style.top)||0,ox:d.pageX||d.screenX,oy:d.pageY||d.screenY};a(document).bind("mouseup",a.rwdrag.stop);a(document).bind("mousemove",a.rwdrag.drag)}},drag:function(j){if(!j){var j=window.event}var h=a.rwdrag.current;var d=a.data(h.el,"pp-rwdrag");var g=(h.oleft+(j.pageX||j.clientX)-h.ox);var f=(h.otop+(j.pageY||j.clientY)-h.oy);if(f<1){f=0}if(d.options.move=="horizontal"){if((d.options.minW&&g>=a(d.options.obj).cssv("left")+d.options.minW)&&(d.options.maxW&&g<=a(d.options.obj).cssv("left")+d.options.maxW)){h.el.style.left=g+"px"}else{if(d.options.scop){if(d.options.relObj){if((g-parseInt(d.options.relObj.style.left))>d.options.cellMinW){h.el.style.left=g+"px"}}else{h.el.style.left=g+"px"}}}}else{if(d.options.move=="vertical"){h.el.style.top=f+"px"}else{var b=d.options.selector?a(d.options.selector,d.options.obj):a(d.options.obj);var c=b.offset();if(g>=-b.outerWidth()*2/3&&f>=0&&(g+b.outerWidth()/3<a(window).width())&&(f+b.outerHeight()<a(window).height())){h.el.style.left=g+"px";h.el.style.top=f+"px"}}}if(d.options.drag){d.options.drag.apply(h.el,[h.el])}return a.rwdrag.preventEvent(j)},stop:function(d){var c=a.rwdrag.current;var b=a.data(c.el,"pp-rwdrag");a(document).unbind("mousemove",a.rwdrag.drag);a(document).unbind("mouseup",a.rwdrag.stop);if(b.options.stop){b.options.stop.apply(c.el,[c.el])}a.rwdrag.current=null;return a.rwdrag.preventEvent(d)},preventEvent:function(b){if(b.stopPropagation){b.stopPropagation()}if(b.preventDefault){b.preventDefault()}return false}}})(jQuery);$.setRegional("alertMsg",{title:{error:"错误",info:"提示",warn:"警告",correct:"成功",confirm:"确认提示"},butMsg:{ok:"确定",yes:"是",no:"否",cancel:"取消"}});var alertMsg={_boxId:"#alertMsgBox",_bgId:"#alertBackground",_closeTimer:null,_butsHtmlTemplate:"<li><a class='button' rel='#callback#' onclick='alertMsg.close()' href='javascript:'><span>#butMsg#</span></a></li>",_boxHtmlTemplate:"<div id='alertMsgBox' class='alert'><div class='alertContent'><div class='#type#'><div class='alertInner'><h1>#title#</h1><div class='msg'>#message#</div></div><div class='toolBar'><ul>#butFragment#</ul></div></div></div><div class='alertFooter'><div class='alertFooter_r'><div class='alertFooter_c'></div></div></div></div>",_types:{error:"error",info:"info",warn:"warn",correct:"correct",confirm:"confirm"},_getTitle:function(a){return $.regional.alertMsg.title[a]},_open:function(e,g,f){$(this._boxId).remove();var a="";if(f){for(var d=0;d<f.length;d++){var c=f[d].call?"callback":"";a+=this._butsHtmlTemplate.replace("#butMsg#",f[d].name).replace("#callback#",c)}}var h=this._boxHtmlTemplate.replace("#type#",e).replace("#title#",this._getTitle(e)).replace("#message#",g).replace("#butFragment#",a);$(h).appendTo("body").css({top:-$(this._boxId).height()+"px"}).animate({top:"0px"},500);if(this._closeTimer){clearTimeout(this._closeTimer);this._closeTimer=null}if(this._types.info==e||this._types.correct==e){this._closeTimer=setTimeout(function(){alertMsg.close()},3500)}else{$(this._bgId).show()}var b=$(this._boxId).find("[rel=callback]");for(var d=0;d<f.length;d++){if(f[d].call){b.eq(d).click(f[d].call)}}},close:function(){$(this._boxId).animate({top:-$(this._boxId).height()},500,function(){$(this).remove()});$(this._bgId).hide()},error:function(b,a){this._alert(this._types.error,b,a)},info:function(b,a){this._alert(this._types.info,b,a)},warn:function(b,a){this._alert(this._types.warn,b,a)},correct:function(b,a){this._alert(this._types.correct,b,a)},_alert:function(b,d,a){var e={okName:$.regional.alertMsg.butMsg.ok,okCall:null};$.extend(e,a);var c=[{name:e.okName,call:e.okCall}];this._open(b,d,c)},confirm:function(c,a){var d={okName:$.regional.alertMsg.butMsg.ok,okCall:null,cancelName:$.regional.alertMsg.butMsg.cancel,cancelCall:null};$.extend(d,a);var b=[{name:d.okName,call:d.okCall},{name:d.cancelName,call:d.cancelCall}];this._open(this._types.confirm,c,b)}};(function(g){var c=new Map();g.bee=g.bee||{};g(window).resize(function(){setTimeout(function(){for(var j=0;j<c.size();j++){d(c.element(j).key)}},100)});g.fn.extend({accordion:function(k,l){var j=Array.prototype.slice.call(arguments,1);return this.each(function(){if(k.fillSpace){c.put(k.fillSpace,this)}if(typeof k=="string"){var m=g.data(this,"bee-accordion");m[k].apply(m,j)}else{if(!g(this).is(".bee-accordion")){g.data(this,"bee-accordion",new g.bee.accordion(this,k))}}})},activate:function(j){return this.accordion("activate",j)}});g.bee.accordion=function(j,k){this.options=k=g.extend({},g.bee.accordion.defaults,k);this.element=j;g(j).addClass("bee-accordion");if(k.navigation){var m=g(j).find("a").filter(k.navigationFilter);if(m.length){if(m.filter(k.header).length){k.active=m}else{k.active=m.parent().parent().prev();m.addClass("current")}}}k.headers=g(j).find(k.header);k.active=e(k.headers,k.active);if(k.fillSpace){d(k.fillSpace)}else{if(k.autoheight){var l=0;k.headers.next().each(function(){l=Math.max(l,g(this).outerHeight())}).height(l)}}k.headers.not(k.active||"").next().hide();k.active.find("h2").addClass(k.selectedClass);if(k.event){g(j).bind((k.event)+".bee-accordion",h)}};g.bee.accordion.prototype={activate:function(j){h.call(this.element,{target:e(this.options.headers,j)[0]})},enable:function(){this.options.disabled=false},disable:function(){this.options.disabled=true},destroy:function(){this.options.headers.next().css("display","");if(this.options.fillSpace||this.options.autoheight){this.options.headers.next().css("height","")}g.removeData(this.element,"bee-accordion");g(this.element).removeClass("bee-accordion").unbind(".bee-accordion")}};function b(k,j){return function(){return k.apply(j,arguments)}}function f(l){if(!g.data(this,"bee-accordion")){return}var j=g.data(this,"bee-accordion");var k=j.options;k.running=l?0:--k.running;if(k.running){return}if(k.clearStyle){k.toShow.add(k.toHide).css({height:"",overflow:""})}g(this).triggerHandler("change.bee-accordion",[k.data],k.change)}function d(k){var o=c.get(k);if(!o){return}var n=g(".accordionHeader:first-child",o).outerHeight();if(n==0){n=25}var l=g(o).parent();var j=l.height()-((g(".accordionHeader",o).size())*n)-2;var m=l.children().not(o);g.each(m,function(p){j-=g(m[p]).outerHeight()});g(".accordionContent",o).height(j)}function a(j,n,o,m,p){var l=g.data(this,"bee-accordion").options;l.toShow=j;l.toHide=n;l.data=o;var k=b(f,this);l.running=n.size()==0?j.size():n.size();if(l.animated){if(!l.alwaysOpen&&m){g.bee.accordion.animations[l.animated]({toShow:jQuery([]),toHide:n,complete:k,down:p,autoheight:l.autoheight})}else{g.bee.accordion.animations[l.animated]({toShow:j,toHide:n,complete:k,down:p,autoheight:l.autoheight})}}else{if(!l.alwaysOpen&&m){j.toggle()}else{n.hide();j.show()}k(true)}}function h(o){var m=g.data(this,"bee-accordion").options;if(m.disabled){return false}if(!o.target&&!m.alwaysOpen){m.active.find("h2").toggleClass(m.selectedClass);var l=m.active.next(),p={instance:this,options:m,newHeader:jQuery([]),oldHeader:m.active,newContent:jQuery([]),oldContent:l},j=m.active=g([]);a.call(this,j,l,p);return false}var n=g(o.target);if(n.parents(m.header).length){while(!n.is(m.header)){n=n.parent()}}var k=n[0]==m.active[0];if(m.running||(m.alwaysOpen&&k)){return false}if(!n.is(m.header)){return}m.active.find("h2").toggleClass(m.selectedClass);if(!k){n.find("h2").addClass(m.selectedClass)}var j=n.next(),l=m.active.next(),p={instance:this,options:m,newHeader:n,oldHeader:m.active,newContent:j,oldContent:l},q=m.headers.index(m.active[0])>m.headers.index(n[0]);m.active=k?g([]):n;a.call(this,j,l,p,k,q);return false}function e(k,j){return j!=undefined?typeof j=="number"?k.filter(":eq("+j+")"):k.not(k.not(j)):j===false?g([]):k.filter(":eq(0)")}g.extend(g.bee.accordion,{defaults:{selectedClass:"collapsable",alwaysOpen:true,animated:"slide",event:"click",header:".accordionHeader",autoheight:true,running:0,navigationFilter:function(){return this.href.toLowerCase()==location.href.toLowerCase()}},animations:{slide:function(j,l){j=g.extend({easing:"swing",duration:300},j,l);if(!j.toHide.size()){j.toShow.animate({height:"show"},j);return}var k=j.toHide.height(),m=j.toShow.height(),n=m/k;j.toShow.css({height:0}).show();j.toHide.filter(":hidden").each(j.complete).end().filter(":visible").animate({height:"hide"},{step:function(o){var p=(k-o)*n;if(g.browser.msie||g.browser.opera){p=Math.ceil(p)}j.toShow.height(p)},duration:j.duration,easing:j.easing,complete:function(){if(!j.autoheight){j.toShow.css("height","auto")}j.complete()}})},bounceslide:function(j){this.slide(j,{easing:j.down?"bounceout":"swing",duration:j.down?1000:200})},easeslide:function(j){this.slide(j,{easing:"easeinout",duration:700})}}})})(jQuery);(function(a){a.fn.cssv=function(b){var c=a(this).css(b);return c.substring(0,c.indexOf("px"))*1};a.fn.jBar=function(b){var c=a.extend({container:"#container",collapse:".collapse",toggleBut:".toggleCollapse div",sideBar:"#sidebar",sideBar2:"#sidebar_s",splitBar:"#splitBar",splitBar2:"#splitBarProxy"},b);return this.each(function(){var f=this;var d=a(c.sideBar2,f);var e=a(c.sideBar,f);a(c.toggleBut,e).click(function(){bee.ui.sbar=false;a(c.splitBar).hide();var k=d.cssv("left")+d.outerWidth();var g=k-e.outerWidth();var j=a(c.container).cssv("left")-(e.outerWidth()-d.outerWidth());var h=e.outerWidth()-d.outerWidth()+a(c.container).outerWidth();a(c.container).animate({left:j,width:h},50,function(){e.animate({left:g},500,function(){e.hide();d.show().css("left",-50).animate({left:5},200);a(window).trigger("resizeGrid")})});a(c.collapse,d).click(function(){var m=d.cssv("left")+d.outerWidth();if(e.is(":hidden")){a(c.toggleBut,e).hide();e.show().animate({left:m},500);a(c.container).click(l)}else{e.animate({left:g},500,function(){e.hide()})}function l(){a(c.container).unbind("click",l);if(!bee.ui.sbar){e.animate({left:g},500,function(){e.hide()})}}return false});return false});a(c.toggleBut,d).click(function(){bee.ui.sbar=true;d.animate({left:-25},200,function(){e.show()});e.animate({left:5},800,function(){a(c.splitBar).show();a(c.toggleBut,e).show();var h=5+e.outerWidth()+a(c.splitBar).outerWidth();var g=a(c.container).outerWidth()-(h-a(c.container).cssv("left"));a(c.container).css({left:h,width:g});a(c.collapse,d).unbind("click");a(window).trigger("resizeGrid")});return false});a(c.splitBar).mousedown(function(g){a(c.splitBar2).each(function(){var h=a(this);setTimeout(function(){h.show()},100);h.css({visibility:"visible",left:a(c.splitBar).css("left")});h.jDrag(a.extend(b,{obj:a("#sidebar"),move:"horizontal",event:g,stop:function(){a(this).css("visibility","hidden");var j=a(this).cssv("left")-a(c.splitBar).cssv("left");var m=e.outerWidth()+j;var l=a(c.container).cssv("left")+j;var k=a(c.container).outerWidth()-j;e.css("width",m);a(c.splitBar).css("left",a(this).css("left"));a(c.container).css({left:l,width:k})}}));return false})})})}})(jQuery);(function(a){a.pdialog={_op:{height:300,width:580,minH:40,minW:50,total:20,max:false,mask:false,resizable:true,drawable:true,maxable:true,minable:true,fresh:true},_current:null,_zIndex:42,getCurrent:function(){if(this._current==null){this._current=a("body>.dialog:last")}return this._current},reload:function(c,b){var f=a.extend({data:{},dialogId:"",callback:null},b);var d=(f.dialogId&&a("body").data(f.dialogId))||this._current;if(d){var e=d.find(".dialogContent");e.ajaxUrl({type:"POST",url:c,data:f.data,callback:function(g){e.find("[layoutH]").layoutH(e);a(".pageContent",d).width(a(d).width()-14);a(":button.close, a.close",d).click(function(){a.pdialog.close(d);return false});if(a.isFunction(f.callback)){f.callback(g)}}})}},open:function(c,f,g,b){var h=a.extend({},a.pdialog._op,b);var d=a("body").data(f);if(d){if(d.is(":hidden")){d.show()}if(h.fresh||c!=a(d).data("url")){d.data("url",c);d.find(".dialogHeader").find("h1").html(g);this.switchDialog(d);var e=d.find(".dialogContent");e.loadUrl(c,{},function(){e.find("[layoutH]").layoutH(e);a(".pageContent",d).width(a(d).width()-14);a("button.close, a.close").click(function(){a.pdialog.close(d);return false})})}}else{a("body").append(bee.frag.dialogFrag);d=a(">.dialog:last-child","body");d.data("id",f);d.data("url",c);if(b.close){d.data("close",b.close)}if(b.param){d.data("param",b.param)}(a.fn.bgiframe&&d.bgiframe());d.find(".dialogHeader").find("h1").html(g);a(d).css("zIndex",(a.pdialog._zIndex+=2));a("div.shadow").css("zIndex",a.pdialog._zIndex-3).show();a.pdialog._init(d,b);a(d).click(function(){a.pdialog.switchDialog(d)});a("a.close",d).click(function(j){a.pdialog.close(d);return false});if(h.maxable){a("a.maximize",d).show().click(function(j){a.pdialog.switchDialog(d);a.pdialog.maxsize(d);d.jresize("destroy").dialogDrag("destroy");return false})}else{a("a.maximize",d).hide()}a("a.restore",d).click(function(j){a.pdialog.restore(d);d.jresize().dialogDrag();return false});if(h.minable){a("a.minimize",d).show().click(function(j){a.pdialog.minimize(d);return false})}else{a("a.minimize",d).hide()}a("div.dialogHeader a",d).mousedown(function(){return false});a("div.dialogHeader",d).dblclick(function(){if(a("a.restore",d).is(":hidden")){a("a.maximize",d).trigger("click")}else{a("a.restore",d).trigger("click")}});if(h.max){a.pdialog.maxsize(d)}a("body").data(f,d);a.pdialog._current=d;a.pdialog.attachShadow(d);var e=a(".dialogContent",d);e.loadUrl(c,{},function(){e.find("[layoutH]").layoutH(e);a(".pageContent",d).width(a(d).width()-14);a("a.close").click(function(){a.pdialog.close(d);return false})})}if(h.mask){a(d).css("zIndex",1000);a("a.minimize",d).hide();a(d).data("mask",true);a("#dialogBackground").show()}else{}},switchDialog:function(c){var b=a(c).css("zIndex");a.pdialog.attachShadow(c);if(a.pdialog._current){var d=a(a.pdialog._current).css("zIndex");a(a.pdialog._current).css("zIndex",b);a(c).css("zIndex",d);a("div.shadow").css("zIndex",d-1);a.pdialog._current=c}},attachShadow:function(b){var c=a("div.shadow");if(c.is(":hidden")){c.show()}c.css({top:parseInt(a(b)[0].style.top)-2,left:parseInt(a(b)[0].style.left)-4,height:parseInt(a(b).height())+8,width:parseInt(a(b).width())+8,zIndex:parseInt(a(b).css("zIndex"))-1});a(".shadow_c",c).children().andSelf().each(function(){a(this).css("height",a(b).outerHeight()-4)})},_init:function(d,c){var g=a.extend({},this._op,c);var b=g.height>g.minH?g.height:g.minH;var e=g.width>g.minW?g.width:g.minW;if(isNaN(d.height())||d.height()<b){a(d).height(b+"px");a(".dialogContent",d).height(b-a(".dialogHeader",d).outerHeight()-a(".dialogFooter",d).outerHeight()-6)}if(isNaN(d.css("width"))||d.width()<e){a(d).width(e+"px")}var f=(a(window).height()-d.height())/2;d.css({left:(a(window).width()-d.width())/2,top:f>0?f:0})},initResize:function(c,b,d){a("body").css("cursor",d+"-resize");c.css({top:a(b).css("top"),left:a(b).css("left"),height:a(b).css("height"),width:a(b).css("width")});c.show()},repaint:function(c,b){var d=a("div.shadow");if(c!="w"&&c!="e"){d.css("height",d.outerHeight()+b.tmove);a(".shadow_c",d).children().andSelf().each(function(){a(this).css("height",a(this).outerHeight()+b.tmove)})}if(c=="n"||c=="nw"||c=="ne"){d.css("top",b.otop-2)}if(b.owidth&&(c!="n"||c!="s")){d.css("width",b.owidth+8)}if(c.indexOf("w")>=0){d.css("left",b.oleft-4)}},resizeTool:function(d,c,b){a("div[class^='resizable']",b).filter(function(){return a(this).attr("tar")=="w"||a(this).attr("tar")=="e"}).each(function(){a(this).css("height",a(this).outerHeight()+c)})},resizeDialog:function(j,d,h){var c=parseInt(j.style.left);var f=parseInt(j.style.top);var b=parseInt(j.style.height);var e=parseInt(j.style.width);if(h=="n"||h=="nw"){tmove=parseInt(a(d).css("top"))-f}else{tmove=b-parseInt(a(d).css("height"))}a(d).css({left:c,width:e,top:f,height:b});a(".dialogContent",d).css("width",(e-12)+"px");a(".pageContent",d).css("width",(e-14)+"px");if(h!="w"&&h!="e"){var g=a(".dialogContent",d);g.css({height:b-a(".dialogHeader",d).outerHeight()-a(".dialogFooter",d).outerHeight()-6});g.find("[layoutH]").layoutH(g);a.pdialog.resizeTool(h,tmove,d)}a.pdialog.repaint(h,{oleft:c,otop:f,tmove:tmove,owidth:e});a(window).trigger("resizeGrid")},close:function(b){if(typeof b=="string"){b=a("body").data(b)}if(!b){return}var e=b.data("close");var c=true;if(e&&a.isFunction(e)){var d=b.data("param");if(d&&d!=""){d=bee.jsonEval(d);c=e(d)}else{c=e()}if(!c){return}}if(a.fn.xheditor){a("textarea.editor",b).xheditor(false)}a(b).unbind("click").hide();a("div.dialogContent",b).html("");a("div.shadow").hide();if(a(b).data("mask")){a("#dialogBackground").hide()}else{}a("body").removeData(a(b).data("id"));a(b).remove()},closeCurrent:function(){this.close(a.pdialog._current);if(a.pdialog.getCurrent){a.pdialog._current=a.pdialog.getCurrent()}},checkTimeout:function(){var c=a(".dialogContent",a.pdialog._current);var b=bee.jsonEval(c.html());if(b&&!b.status){this.closeCurrent()}},maxsize:function(c){a(c).data("original",{top:a(c).css("top"),left:a(c).css("left"),width:a(c).css("width"),height:a(c).css("height")});a("a.maximize",c).hide();a("a.restore",c).show();var d=a(window).width();var b=a(window).height()-34;a(c).css({top:"0px",left:"0px",width:d+"px",height:b+"px"});a.pdialog._resizeContent(c,d,b)},restore:function(c){var b=a(c).data("original");var d=parseInt(b.width);var e=parseInt(b.height);a(c).css({top:b.top,left:b.left,width:d,height:e});a.pdialog._resizeContent(c,d,e);a("a.maximize",c).show();a("a.restore",c).hide();a.pdialog.attachShadow(c)},minimize:function(c){a(c).hide();a("div.shadow").hide();var b=a.taskBar.getTask(a(c).data("id"));a(".resizable").css({top:a(c).css("top"),left:a(c).css("left"),height:a(c).css("height"),width:a(c).css("width")}).show().animate({top:a(window).height()-60,left:b.position().left,width:b.outerWidth(),height:b.outerHeight()},250,function(){a(this).hide();a.taskBar.inactive(a(c).data("id"))})},_resizeContent:function(c,d,b){var e=a(".dialogContent",c);e.css({width:(d-12)+"px",height:b-a(".dialogHeader",c).outerHeight()-a(".dialogFooter",c).outerHeight()-6});e.find("[layoutH]").layoutH(e);a(".pageContent",c).css("width",(d-14)+"px");a(window).trigger("resizeGrid")}}})(jQuery);(function($){$.extend($.fn,{jTree:function(options){var op=$.extend({checkFn:null,selected:"selected",exp:"expandable",coll:"collapsable",firstExp:"first_expandable",firstColl:"first_collapsable",lastExp:"last_expandable",lastColl:"last_collapsable",folderExp:"folder_expandable",folderColl:"folder_collapsable",endExp:"end_expandable",endColl:"end_collapsable",file:"file",ck:"checked",unck:"unchecked"},options);return this.each(function(){var $this=$(this);var cnum=$this.children().length;$(">li",$this).each(function(){var $li=$(this);var first=$li.prev()[0]?false:true;var last=$li.next()[0]?false:true;$li.genTree({icon:$this.hasClass("treeFolder"),ckbox:$this.hasClass("treeCheck"),readonly:$this.hasClass("readonly"),uncheckparent:$this.hasClass("treealone"),options:op,level:0,exp:(cnum>1?(first?op.firstExp:(last?op.lastExp:op.exp)):op.endExp),coll:(cnum>1?(first?op.firstColl:(last?op.lastColl:op.coll)):op.endColl),showSub:(!$this.hasClass("collapse")&&($this.hasClass("expand")||(cnum>1?(first?true:false):true))),isLast:(cnum>1?(last?true:false):true)})});setTimeout(function(){if($this.hasClass("treeCheck")){var checkFn=eval($this.attr("oncheck"));if(checkFn&&$.isFunction(checkFn)){$("div.ckbox",$this).each(function(){var ckbox=$(this);ckbox.click(function(){var checked=$(ckbox).hasClass("checked");var items=[];var tnode=$(ckbox).parent().parent();var boxes=$("input",tnode);items={name:boxes.attr("name"),value:boxes.val(),text:boxes.attr("text")};checkFn({checked:checked,items:items})})})}}if(!$this.hasClass("readonly")){$("a",$this).click(function(event){$("div."+op.selected,$this).removeClass(op.selected);var parent=$(this).parent().addClass(op.selected);$(".ckbox",parent).trigger("click");event.stopPropagation();$(document).trigger("click");if(!$(this).attr("target")){return false}})}},1)})},subTree:function(op,level){return this.each(function(){$(">li",this).each(function(){var $this=$(this);var isLast=($this.next()[0]?false:true);$this.genTree({icon:op.icon,ckbox:op.ckbox,exp:isLast?op.options.lastExp:op.options.exp,coll:isLast?op.options.lastColl:op.options.coll,options:op.options,level:level,uncheckparent:op.uncheckparent,readonly:op.readonly,space:isLast?null:op.space,showSub:op.showSub,isLast:isLast})})})},genTree:function(options){var op=$.extend({icon:options.icon,ckbox:options.ckbox,exp:"",coll:"",showSub:false,level:0,options:null,isLast:false},options);return this.each(function(){var node=$(this);var tree=$(">ul",node);var parent=node.parent().prev();var checked="unchecked";if(op.ckbox){if($(">.checked",parent).size()>0){checked="checked"}}var selected="";if(node.hasClass("selected")){selected=' class="selected"'}if(tree.size()>0){node.children(":first").wrap("<div "+selected+"></div>");$(">div",node).prepend("<div class='"+(op.showSub?op.coll:op.exp)+"'></div>"+(op.ckbox?"<div class='ckbox "+checked+"'></div>":"")+(op.icon?"<div class='"+(op.showSub?op.options.folderColl:op.options.folderExp)+"'></div>":""));op.showSub?tree.show():tree.hide();$(">div>div:first,>div>a",node).click(function(){var $fnode=$(">li:first",tree);if($fnode.children(":first").isTag("a")){tree.subTree(op,op.level+1)}var $this=$(this);var isA=$this.isTag("a");var $this=isA?$(">div>div",node).eq(op.level):$this;if(!isA||tree.is(":hidden")){$this.toggleClass(op.exp).toggleClass(op.coll);if(op.icon){$(">div>div:last",node).toggleClass(op.options.folderExp).toggleClass(op.options.folderColl)}}(tree.is(":hidden"))?tree.slideDown("fast"):(isA?"":tree.slideUp("fast"));return false});addSpace(op.level,node);if(op.showSub){tree.subTree(op,op.level+1)}}else{node.children().wrap("<div></div>");$(">div",node).prepend("<div class='node'></div>"+(op.ckbox?"<div class='ckbox "+checked+"'></div>":"")+(op.icon?"<div class='file'></div>":""));addSpace(op.level,node);if(op.isLast){$(node).addClass("last")}}if(op.ckbox){node._check(op)}$(">div",node).mouseover(function(){$(this).addClass("hover")}).mouseout(function(){$(this).removeClass("hover")});if($.browser.msie){$(">div",node).click(function(){$("a",this).trigger("click");return false})}});function addSpace(level,node){if(level>0){var parent=node.parent().parent();var space=!parent.next()[0]?"indent":"line";var plist="<div class='"+space+"'></div>";if(level>1){var next=$(">div>div",parent).filter(":first");var prev="";while(level>1){prev=prev+"<div class='"+next.attr("class")+"'></div>";next=next.next();level--}plist=prev+plist}$(">div",node).prepend(plist)}}},treeVal:function(value){if(!arguments.length){var retValue=[];$this=$(this);function GetVal(li){$(">div>div.checked",li).each(function(){retValue.push($(":checkbox",this).val())});$(">ul>li",li).each(function(){GetVal($(this))})}$(">li",$this).each(function(){GetVal($(this))});return retValue.toString()}else{if(!value){value=""}value=","+value+",";$this=$(this);function SetVal(li){var itemValue=$(">div>div>input",li).val();var treeUnready=!itemValue;if(treeUnready){itemValue=$(">a",li).attr("tvalue")}if(value.indexOf(","+itemValue+",")>=0){if(treeUnready){$(">a",li).attr("checked","true");li.addClass("selected")}else{$ckbox=$(">div>div.ckbox",li);var cked=$ckbox.hasClass("checked");if(!cked){$(">div>div>:checkbox",li).trigger("click")}}}else{if(treeUnready){$(">a",li).removeAttr("checked")}else{$ckbox=$(">div>div.ckbox",li);var cked=$ckbox.hasClass("checked");if(cked){$(">div>div>:checkbox",li).trigger("click")}}}$(">ul>li",li).each(function(){SetVal($(this))})}$(">li",$this).each(function(){SetVal($(this))})}},_check:function(op){var node=$(this);var ckbox=$(">div>.ckbox",node);var $input=node.find("a");var tname=$input.attr("tname"),tvalue=$input.attr("tvalue");var attrs="text='"+$input.text()+"' ";if(tname){attrs+="name='"+tname+"' "}if(tvalue){attrs+="value='"+tvalue+"' "}ckbox.append("<input type='checkbox' style='display:none;' "+attrs+"/>");if(!op.readonly){ckbox.click(function(){var cked=ckbox.hasClass("checked");var aClass=cked?"unchecked":"checked";var rClass=cked?"checked":"unchecked";ckbox.removeClass(rClass).removeClass(!cked?"indeterminate":"").addClass(aClass);$("input",ckbox).attr("checked",!cked);if(!op.uncheckparent){$(">ul",node).find("li").each(function(){var box=$("div.ckbox",this);box.removeClass(rClass).removeClass(!cked?"indeterminate":"").addClass(aClass).find("input").attr("checked",!cked)})}if(!op.uncheckparent){$(node)._checkParent()}return false})}var cAttr=$input.attr("checked")||false;if(cAttr){ckbox.find("input").attr("checked",true);ckbox.removeClass("unchecked").addClass("checked");if(!op.uncheckparent){$(node)._checkParent()}}},_checkParent:function(){if($(this).parent().hasClass("tree")){return}var parent=$(this).parent().parent();var stree=$(">ul",parent);var ckbox=stree.find(">li>a").size()+stree.find("div.ckbox").size();var ckboxed=stree.find("div.checked").size();var aClass=(ckboxed==ckbox?"checked":(ckboxed!=0?"indeterminate":"unchecked"));var rClass=(ckboxed==ckbox?"indeterminate":(ckboxed!=0?"checked":"indeterminate"));$(">div>.ckbox",parent).removeClass("unchecked").removeClass("checked").removeClass(rClass).addClass(aClass);parent._checkParent()}})})(jQuery);(function(a){a.fn.extend({pagination:function(d){var c={first$:"li.j-first",prev$:"li.j-prev",next$:"li.j-next",last$:"li.j-last",nums$:"li.j-num>a",jumpto$:"li.jumpto",pageNumFrag:'<li class="#liClass#"><a href="javascript:;">#pageNum#</a></li>'};return this.each(function(){var l=a(this);var n=new b(d);var f=n.getInterval();var o="";for(var k=f.start;k<f.end;k++){o+=c.pageNumFrag.replaceAll("#pageNum#",k).replaceAll("#liClass#",k==n.getCurrentPage()?"selected j-num":"j-num")}l.html(bee.frag.pagination.replaceAll("#pageNumFrag#",o).replaceAll("#currentPage#",n.getCurrentPage())).find("li").hoverClass();var j=l.find(c.first$);var g=l.find(c.prev$);var h=l.find(c.next$);var m=l.find(c.last$);if(n.hasPrev()){j.add(g).find(">span").hide();e(g,n.getCurrentPage()-1,n.targetType(),n.rel());e(j,1,n.targetType(),n.rel())}else{j.add(g).addClass("disabled").find(">a").hide()}if(n.hasNext()){h.add(m).find(">span").hide();e(h,n.getCurrentPage()+1,n.targetType(),n.rel());e(m,n.numPages(),n.targetType(),n.rel())}else{h.add(m).addClass("disabled").find(">a").hide()}l.find(c.nums$).each(function(p){e(a(this),p+f.start,n.targetType(),n.rel())});l.find(c.jumpto$).each(function(){var r=a(this);var q=r.find(":text");var p=r.find(":button");p.click(function(s){var t=q.val();if(t&&t.isPositiveInteger()){dwzPageBreak({targetType:n.targetType(),rel:n.rel(),data:{pageNum:t}})}});q.keyup(function(s){if(s.keyCode==bee.keyCode.ENTER){p.click()}})})});function e(g,j,h,f){g.bind("click",{pageNum:j},function(k){dwzPageBreak({targetType:h,rel:f,data:{pageNum:k.data.pageNum}});k.preventDefault()})}},orderBy:function(c){var d=a.extend({targetType:"navTab",rel:"",asc:"asc",desc:"desc"},c);return this.each(function(){var e=a(this).css({cursor:"pointer"}).click(function(){var g=e.attr("orderField");var f=e.hasClass(d.asc)?d.desc:d.asc;dwzPageBreak({targetType:d.targetType,rel:d.rel,data:{orderField:g,orderDirection:f}})})})},pagerForm:function(c){var e=a.extend({pagerForm$:"#pagerForm",parentBox:document},c);var d='<input type="hidden" name="#name#" value="#value#" />';return this.each(function(){var f=a(this),g=a(e.pagerForm$,e.parentBox);var h=g.attr("action").replaceAll("#rel#",f.attr("action"));g.attr("action",h);f.find(":input").each(function(){var l=a(this),j=l.attr("name");if(j&&(!l.is(":checkbox,:radio")||l.is(":checked"))){if(g.find(":input[name='"+j+"']").length==0){var k=d.replaceAll("#name#",j).replaceAll("#value#",l.val());g.append(k)}}})})}});var b=function(c){this.opts=a.extend({targetType:"navTab",rel:"",totalCount:0,numPerPage:10,pageNumShown:10,currentPage:1,callback:function(){return false}},c)};a.extend(b.prototype,{targetType:function(){return this.opts.targetType},rel:function(){return this.opts.rel},numPages:function(){return Math.ceil(this.opts.totalCount/this.opts.numPerPage)},getInterval:function(){var e=Math.ceil(this.opts.pageNumShown/2);var f=this.numPages();var d=f-this.opts.pageNumShown;var g=this.getCurrentPage()>e?Math.max(Math.min(this.getCurrentPage()-e,d),0):0;var c=this.getCurrentPage()>e?Math.min(this.getCurrentPage()+e,f):Math.min(this.opts.pageNumShown,f);return{start:g+1,end:c+1}},getCurrentPage:function(){var c=parseInt(this.opts.currentPage);if(isNaN(c)){return 1}return c},hasPrev:function(){return this.getCurrentPage()>1},hasNext:function(){return this.getCurrentPage()<this.numPages()}})})(jQuery);(function(a){a.fn.extend({checkboxCtrl:function(b){return this.each(function(){var c=a(this);c.click(function(){var e=c.attr("group");if(c.is(":checkbox")){var d=c.is(":checked")?"all":"none";if(e){a.checkbox.select(e,d,b)}}else{if(e){a.checkbox.select(e,c.attr("selectType")||"all",b)}}})})}});a.checkbox={selectAll:function(b,c){this.select(b,"all",c)},unSelectAll:function(b,c){this.select(b,"none",c)},selectInvert:function(b,c){this.select(b,"invert",c)},select:function(b,c,d){$parent=a(d||document);$checkboxLi=$parent.find(":checkbox[name='"+b+"']");switch(c){case"invert":$checkboxLi.each(function(){$checkbox=a(this);$checkbox.attr("checked",!$checkbox.is(":checked"))});break;case"none":$checkboxLi.attr("checked",false);break;default:$checkboxLi.attr("checked",true);break}}}})(jQuery);var navTab={componentBox:null,_tabBox:null,_prevBut:null,_nextBut:null,_panelBox:null,_moreBut:null,_moreBox:null,_currentIndex:0,_op:{id:"navTab",stTabBox:".navTab-tab",stPanelBox:".navTab-panel",mainTabId:"main",close$:"a.close",prevClass:"tabsLeft",nextClass:"tabsRight",stMore:".tabsMore",stMoreLi:"ul.tabsMoreList"},init:function(a){if($.History){$.History.init("#container")}var b=this;$.extend(this._op,a);this.componentBox=$("#"+this._op.id);this._tabBox=this.componentBox.find(this._op.stTabBox);this._panelBox=this.componentBox.find(this._op.stPanelBox);this._prevBut=this.componentBox.find("."+this._op.prevClass);this._nextBut=this.componentBox.find("."+this._op.nextClass);this._moreBut=this.componentBox.find(this._op.stMore);this._moreBox=this.componentBox.find(this._op.stMoreLi);this._prevBut.click(function(c){b._scrollPrev()});this._nextBut.click(function(c){b._scrollNext()});this._moreBut.click(function(c){if(b._moreBut.offset().top>100){b._moreBox.css("bottom","24px").css("top","auto").show()}else{b._moreBox.show()}return false});$(document).click(function(){b._moreBox.hide()});this._contextmenu(this._tabBox);this._contextmenu(this._getTabs());this._init();this._ctrlScrollBut()},_init:function(){var a=this;this._getTabs().each(function(b){$(this).unbind("click").click(function(c){a._switchTab(b)});$(this).find(navTab._op.close$).unbind("click").click(function(){a._closeTab(b)})});this._getMoreLi().each(function(b){$(this).find(">a").unbind("click").click(function(c){a._switchTab(b)})});this._switchTab(this._currentIndex)},_contextmenu:function(b){var a=this;b.contextMenu("navTabCM",{bindings:{reload:function(d,c){a._reload(d,true)},closeCurrent:function(e,c){var d=e.attr("tabid");if(d){a.closeTab(d)}else{a.closeCurrentTab()}},closeOther:function(e,c){var d=a._indexTabId(e.attr("tabid"));a._closeOtherTab(d>0?d:a._currentIndex)},closeAll:function(d,c){a.closeAllTab()}},ctrSub:function(f,c){var g=c.find("[rel='reload']");var h=c.find("[rel='closeCurrent']");var j=c.find("[rel='closeOther']");var e=c.find("[rel='closeAll']");var d=a._getTabs();if(d.size()<2){h.addClass("disabled");j.addClass("disabled");e.addClass("disabled")}if(a._currentIndex==0||f.attr("tabid")==a._op.mainTabId){h.addClass("disabled");g.addClass("disabled")}else{if(d.size()==2){j.addClass("disabled")}}}})},_getTabs:function(){return this._tabBox.find("> li")},_getPanels:function(){return this._panelBox.find("> div")},_getMoreLi:function(){return this._moreBox.find("> li")},_getTab:function(a){var b=this._indexTabId(a);if(b>=0){return this._getTabs().eq(b)}},_getPanel:function(a){var b=this._indexTabId(a);if(b>=0){return this._getPanels().eq(b)}},_getTabsW:function(b,a){return this._tabsW(this._getTabs().slice(b,a))},_tabsW:function(a){var b=0;a.each(function(){b+=$(this).outerWidth(true)});return b},_indexTabId:function(b){if(!b){return -1}var a=-1;this._getTabs().each(function(c){if($(this).attr("tabid")==b){a=c;return}});return a},_getLeft:function(){return this._tabBox.position().left},_getScrollBarW:function(){return this.componentBox.width()-55},_visibleStart:function(){var d=this._getLeft(),b=0;var a=this._getTabs();for(var c=0;c<a.size();c++){if(b+d>=0){return c}b+=a.eq(c).outerWidth(true)}return 0},_visibleEnd:function(){var d=this._getLeft(),b=0;var a=this._getTabs();for(var c=0;c<a.size();c++){b+=a.eq(c).outerWidth(true);if(b+d>this._getScrollBarW()){return c}}return a.size()},_scrollPrev:function(){var a=this._visibleStart();if(a>0){this._scrollTab(-this._getTabsW(0,a-1))}},_scrollNext:function(){var a=this._visibleEnd();if(a<this._getTabs().size()){this._scrollTab(-this._getTabsW(0,a+1)+this._getScrollBarW())}},_scrollTab:function(c,a){var b=this;this._tabBox.animate({left:c+"px"},200,function(){b._ctrlScrollBut()})},_scrollCurrent:function(){var a=this._tabsW(this._getTabs());if(a<=this._getScrollBarW()){this._scrollTab(0)}else{if(this._getLeft()<this._getScrollBarW()-a){this._scrollTab(this._getScrollBarW()-a)}else{if(this._currentIndex<this._visibleStart()){this._scrollTab(-this._getTabsW(0,this._currentIndex))}else{if(this._currentIndex>=this._visibleEnd()){this._scrollTab(this._getScrollBarW()-this._getTabs().eq(this._currentIndex).outerWidth(true)-this._getTabsW(0,this._currentIndex))}}}}},_ctrlScrollBut:function(){var a=this._tabsW(this._getTabs());if(this._getScrollBarW()>a){this._prevBut.hide();this._nextBut.hide();this._tabBox.parent().removeClass("tabsPageHeaderMargin")}else{this._prevBut.show().removeClass("tabsLeftDisabled");this._nextBut.show().removeClass("tabsRightDisabled");this._tabBox.parent().addClass("tabsPageHeaderMargin");if(this._getLeft()>=0){this._prevBut.addClass("tabsLeftDisabled")}else{if(this._getLeft()<=this._getScrollBarW()-a){this._nextBut.addClass("tabsRightDisabled")}}}},_switchTab:function(b){var a=this._getTabs().removeClass("selected").eq(b).addClass("selected");this._getPanels().hide().eq(b).show();this._getMoreLi().removeClass("selected").eq(b).addClass("selected");this._currentIndex=b;this._scrollCurrent();this._reload(a)},_closeTab:function(a){this._getTabs().eq(a).remove();this._getPanels().eq(a).remove();this._getMoreLi().eq(a).remove();if(this._currentIndex>=a){this._currentIndex--}this._init();this._scrollCurrent();this._reload(this._getTabs().eq(this._currentIndex))},closeTab:function(a){var b=this._indexTabId(a);if(b>0){this._closeTab(b)}},getCurrentTabIndex:function(){return this._currentIndex},closeCurrentTab:function(){this._closeTab(this._currentIndex)},closeAllTab:function(){this._getTabs().filter(":gt(0)").remove();this._getPanels().filter(":gt(0)").remove();this._getMoreLi().filter(":gt(0)").remove();this._currentIndex=0;this._init();this._scrollCurrent()},_closeOtherTab:function(a){a=a||this._currentIndex;if(a>0){var b=":eq("+a+")";this._getTabs().not(b).filter(":gt(0)").remove();this._getPanels().not(b).filter(":gt(0)").remove();this._getMoreLi().not(b).filter(":gt(0)").remove();this._currentIndex=1;this._init();this._scrollCurrent()}else{this.closeAllTab()}},_loadUrlCallback:function(a){a.find("[layoutH]").layoutH();a.find(":button.close").click(function(){navTab.closeCurrentTab()});a.find("a.close").click(function(){navTab.closeCurrentTab()})},_reload:function(c,a){a=a||c.data("reloadFlag");var b=c.attr("url");if(a&&b){c.data("reloadFlag",null);var d=this._getPanel(c.attr("tabid"));if(c.hasClass("external")){navTab.openExternal(b,d)}else{d.loadUrl(b,{},function(){navTab._loadUrlCallback(d)})}}},reloadCurrent:function(){this._reload(this._getTabs().eq(this._currentIndex),1)},reloadFlag:function(a){var b=this._getTab(a);if(b){if(this._indexTabId(a)==this._currentIndex){this._reload(b,true)}else{b.data("reloadFlag",1)}}},reload:function(b,a){var e=$.extend({data:{},navTabId:"",callback:null},a);var d=e.navTabId?this._getPanel(e.navTabId):this._getPanels().eq(this._currentIndex);if(d){if(!b){var c=e.navTabId?this._getTab(e.navTabId):this._getTabs().eq(this._currentIndex);b=c.attr("url")}if(b){d.loadUrl(b,e.data,function(f){navTab._loadUrlCallback(d);if($.isFunction(e.callback)){e.callback(f)}})}}},getCurrentPanel:function(){return this._getPanels().eq(this._currentIndex)},openExternal:function(a,c){var b=navTab._panelBox.height()},openTab:function(a,b,k){var f=$.extend({title:"New Tab",data:{},fresh:true,external:false},k);var c=this._indexTabId(a);if(c>=0){var h=this._getTabs().eq(c);var d=h.attr("tabid")==this._op.mainTabId?"> a > span > span":"> a > span";h.find(d).text(f.title);var j=this._getPanels().eq(c);if(f.fresh||h.attr("url")!=b){h.attr("url",b);if(f.external||b.isExternalUrl()){h.addClass("external");navTab.openExternal(b,j)}else{h.removeClass("external");j.loadUrl(b,f.data,function(){navTab._loadUrlCallback(j)})}}this._currentIndex=c}else{var e='<li tabid="#tabid#"><a href="javascript:" title="#title#"><span>#title#</span></a><a href="javascript:;" class="close">close</a></li>';this._tabBox.append(e.replace("#tabid#",a).replaceAll("#title#",f.title));this._panelBox.append('<div class="page"></div>');this._moreBox.append('<li><a href="javascript:" title="#title#">#title#</a></li>'.replaceAll("#title#",f.title));var g=this._getTabs();var h=g.filter(":last");var j=this._getPanels().filter(":last");if(f.external||b.isExternalUrl()){h.addClass("external");navTab.openExternal(b,j)}else{h.removeClass("external");j.loadUrl(b,f.data,function(){navTab._loadUrlCallback(j);j.find(navTab._op.close$).click(this.closeCurrentTab);if($.History){$.History.addHistory(a,function(l){var m=navTab._indexTabId(l);if(m>=0){navTab._switchTab(m)}},a)}})}this._currentIndex=g.size()-1;this._contextmenu(g.filter(":last").hoverClass("hover"))}this._init();this._scrollCurrent();this._getTabs().eq(this._currentIndex).attr("url",b)}};(function(a){a.fn.jTable=function(b){return this.each(function(){var m=a(this),w=m.attr("nowrapTD");var s=m.width();var d=[];var j=m.parent().addClass("j-resizeGrid");var t=a(this).attr("layoutH");var o=m.find("thead>tr:last-child").find("th");for(var u=0,r=o.size();u<r;u++){var g=a(o[u]);var v=[],q=g.innerWidth()-(100*g.innerWidth()/s)-2;v[0]=parseInt(q);v[1]=g.attr("align");d[d.length]=v}a(this).wrap("<div class='grid'></div>");var h=m.parent().html(m.html());var z=h.find("thead");z.wrap("<div class='gridHeader'><div class='gridThead'><table style='width:"+(s-20)+"px;'></table></div></div>");var p=a(">tr:last-child",z);var f=a(">th",p);a("th",z).each(function(){var l=a(this);l.html("<div class='gridCol' title='"+l.text()+"'>"+l.html()+"</div>")});f.each(function(l){var C=a(this),B=d[l];C.addClass(B[1]).hoverClass("hover").removeAttr("align").removeAttr("width").width(B[0])}).filter("[orderField]").orderBy({formId:undefined,asc:m.attr("asc")||"asc",desc:m.attr("desc")||"desc"});var c=h.find(">tbody");var e=t?" layoutH='"+t+"'":"";c.wrap("<div class='gridScroller'"+e+" style='width:"+j.width()+"px;'><div class='gridTbody'><table style='width:"+(s-20)+"px;'></table></div></div>");var n=a(">tr:first-child",c);var A=c.find(">tr");A.hoverClass().each(function(){var D=a(this);var B=a(">td",this);for(var C=0;C<B.size();C++){var l=a(B[C]);if(w!="false"){l.html("<div>"+l.html()+"</div>")}if(C<d.length){l.addClass(d[C][1])}}D.click(function(){A.filter(".selected").removeClass("selected");D.addClass("selected")})});a(">td",n).each(function(l){if(l<d.length){a(this).width(d[l][0])}});h.append("<div class='resizeMarker' style='height:300px; left:57px;display:none;'></div><div class='resizeProxy' style='height:300px; left:377px;display:none;'></div>");var x=a(".gridScroller",h);x.scroll(function(B){var C=a(".gridThead",h);if(x.scrollLeft()>0){C.css("position","relative");var l=x.scrollLeft();C.css("left",x.cssv("left")-l)}if(x.scrollLeft()==0){C.css("position","relative");C.css("left","0px")}return false});a(">tr",z).each(function(){a(">th",this).each(function(l){var C=this,B=a(this);B.mouseover(function(D){var E=a.jTableTool.getOffset(C,D).offsetX;if(B.outerWidth()-E<5){B.css("cursor","col-resize").mousedown(function(F){a(".resizeProxy",h).show().css({left:a.jTableTool.getRight(C)-a(".gridScroller",h).scrollLeft(),top:a.jTableTool.getTop(C),height:a.jTableTool.getHeight(C,h),cursor:"col-resize"});a(".resizeMarker",h).show().css({left:a.jTableTool.getLeft(C)+1-a(".gridScroller",h).scrollLeft(),top:a.jTableTool.getTop(C),height:a.jTableTool.getHeight(C,h)});a(".resizeProxy",h).jDrag(a.extend(b,{scop:true,cellMinW:20,relObj:a(".resizeMarker",h)[0],move:"horizontal",event:F,stop:function(){var L=a(".resizeProxy",h).position().left;var O=a(".resizeMarker",h).position().left;var I=L-O-B.outerWidth()-9;var N=a.jTableTool.getColspan(B);var M=a.jTableTool.getCellNum(B);var P=B.width(),G=B.width()+I;var H=a(">td",n).eq(M-1);B.width(G+"px");H.width(G+"px");var K=a(z).parent();K.width((K.width()-P+G)+"px");var J=a(c).parent();J.width((J.width()-P+G)+"px");a(".resizeMarker,.resizeProxy",h).hide()}}))})}else{B.css("cursor",B.attr("orderField")?"pointer":"default");B.unbind("mousedown")}return false})})});function k(){a("div.j-resizeGrid").each(function(){var l=a(this).innerWidth();if(l){a("div.gridScroller",this).width(l+"px");a(".grid table").css({width:l-20})}})}a(window).unbind("resizeGrid").bind("resizeGrid",k)})};a.jTableTool={getLeft:function(c){var b=0;a(c).prevAll().each(function(){b+=a(this).outerWidth()});return b-1},getRight:function(c){var b=0;a(c).prevAll().andSelf().each(function(){b+=a(this).outerWidth()});return b-1},getTop:function(c){var b=0;a(c).parent().prevAll().each(function(){b+=a(this).outerHeight()});return b},getHeight:function(e,d){var b=0;var c=a(e).parent();c.nextAll().andSelf().each(function(){b+=a(this).outerHeight()});a(".gridTbody",d).children().each(function(){b+=a(this).outerHeight()});return b},getCellNum:function(b){return a(b).prevAll().andSelf().size()},getColspan:function(b){return a(b).attr("colspan")||1},getStart:function(b){var c=1;a(b).prevAll().each(function(){c+=parseInt(a(this).attr("colspan")||1)});return c},getPageCoord:function(b){var c={x:0,y:0};while(b){c.x+=b.offsetLeft;c.y+=b.offsetTop;b=b.offsetParent}return c},getOffset:function(h,c){if(a.browser.msie){var d=a(h).offset();var f={offsetX:c.pageX||c.screenX,offsetY:c.pageY||c.screenY};var j={offsetX:f.offsetX-d.left,offsetY:f.offsetY-d.top};return j}var g=c.target;if(g.offsetLeft==undefined){g=g.parentNode}var e=a.jTableTool.getPageCoord(g);var b={x:window.pageXOffset+c.clientX,y:window.pageYOffset+c.clientY};var j={offsetX:b.x-e.x,offsetY:b.y-e.y};return j}}})(jQuery);(function(a){a.fn.extend({cssTable:function(b){return this.each(function(){var f=a(this);var e=f.find("tbody>tr");var c=f.parent();var d=f.hasClass("nowrap");e.hoverClass("hover").each(function(g){var h=a(this);if(!d&&g%2==1){h.addClass("trbg")}h.click(function(){e.filter(".selected").removeClass("selected");h.addClass("selected");var j=h.attr("target");if(j){if(a("#"+j,c).size()==0){c.prepend('<input id="'+j+'" type="hidden" />')}a("#"+j,c).val(h.attr("rel"))}})});f.find("thead [orderField]").orderBy({targetType:f.attr("targetType"),rel:f.attr("rel"),asc:f.attr("asc")||"asc",desc:f.attr("desc")||"desc"})})}})})(jQuery);(function(a){a.fn.extend({tabs:function(c){var e=a.extend({reverse:false,eventType:"click",currentIndex:0,stTabHeader:"> .tabsHeader",stTab:">.tabsHeaderContent>ul",stTabPanel:"> .tabsContent",ajaxClass:"j-ajax",closeClass:"close",prevClass:"tabsLeft",nextClass:"tabsRight"},c);return this.each(function(){d(a(this))});function d(j){var h=j.add(a("> *",j));var g=a(e.stTabHeader,h);var k=a(e.stTab+" li",g);var f=a(e.stTabPanel+" > *",h);k.unbind().find("a").unbind();g.find("."+e.prevClass).unbind();g.find("."+e.nextClass).unbind();k.each(function(l){if(e.currentIndex==l){a(this).addClass("selected");if(a("a",this).hasClass(e.ajaxClass)){var m=f.eq(l);if(a("a",this).attr("href")&&!m.attr("loaded")){m.loadUrl(a("a",this).attr("href"),{},function(){m.find("[layoutH]").layoutH();m.attr("loaded",true)})}}}else{a(this).removeClass("selected")}if(e.eventType=="hover"){a(this).hover(function(n){b(j,l)})}else{a(this).click(function(n){b(j,l)})}a("a",this).each(function(){if(a(this).hasClass(e.ajaxClass)){a(this).click(function(n){var o=f.eq(l);if(this.href&&!o.attr("loaded")){o.loadUrl(this.href,{},function(){o.find("[layoutH]").layoutH();o.attr("loaded",true)})}n.preventDefault()});if(e.currentIndex==l){a(this).trigger("click")}}else{if(a(this).hasClass(e.closeClass)){a(this).click(function(n){k.eq(l).remove();f.eq(l).remove();if(l==e.currentIndex){e.currentIndex=(l+1<k.size())?l:l-1}else{if(l<e.currentIndex){e.currentIndex=l}}d(j);return false})}}})});b(j,e.currentIndex)}function b(k,l){var j=k.add(a("> *",k));var h=a(e.stTabHeader,j);var n=a(e.stTab+" li",h);var f=a(e.stTabPanel+" > *",j);var g=n.eq(l);var m=f.eq(l);if(e.reverse&&(g.hasClass("selected"))){n.removeClass("selected");f.hide()}else{e.currentIndex=l;n.removeClass("selected");g.addClass("selected");f.hide().eq(e.currentIndex).show()}if(!m.attr("inited")){m.attr("inited",1000).find("input[type=text]").filter("[alt]").inputAlert()}}}})})(jQuery);(function($){var _lookup={currentGroup:"",suffix:"",$target:null,pk:"id",$callback:null};var _util={_lookupPrefix:function(key){var strDot=_lookup.currentGroup?".":"";return _lookup.currentGroup+strDot+key+_lookup.suffix},lookupPk:function(key){return this._lookupPrefix(key)},lookupField:function(key){return this.lookupPk(key)}};$.extend({bringBackSuggest:function(args){var $box=_lookup["$target"].parents(".unitBox:first");$box.find(":input").each(function(){var $input=$(this),inputName=$input.attr("name");var inputId=$input.attr("id");for(var key in args){var name=(_lookup.pk==key)?_util.lookupPk(key):_util.lookupField(key);if(name==inputName||name==inputId){$input.val(args[key]);break}}});$box.find("a").each(function(){var $this=$(this);var $thisName=$this.attr("name");var $thisText=$this.attr("tvalue");if(!$thisName||!$thisText){return}for(var key in args){var name=(_lookup.pk==key)?_util.lookupPk(key):_util.lookupField(key);name=name.replaceForId();$thisText=$thisText.replaceAll(name,args[key]);$thisName=$thisName.replaceAll(name,args[key])}if($thisText!=$this.attr("tvalue")||$this.text()==""){$this.text($thisText)}if($thisName!=$this.attr("name")){$this.attr("href",$thisName)}})},bringBack:function(args){$.bringBackSuggest(args);$.pdialog.closeCurrent()},itemBringBack:function(args){if(_lookup.$callback){_lookup.$callback(args)}else{$.bringBack(args[0])}}});$.fn.extend({lookup:function(){return this.each(function(){var $this=$(this),options={mask:true,width:$this.attr("width")||860,height:$this.attr("height")||400,maxable:eval($this.attr("maxable")||"true"),resizable:eval($this.attr("resizable")||"true")};$this.click(function(event){_lookup=$.extend(_lookup,{currentGroup:$this.attr("lookupGroup")||"",suffix:$this.attr("suffix")||"",$target:$this,pk:$this.attr("lookupPk")||"id",$callback:null});var url=unescape($this.attr("href")).replaceTmById($(event.target).parents("form:first"));if(!url.isFinishedTm()){alertMsg.error($this.attr("warn")||bee.msg("alertSelectMsg"));return false}$.pdialog.open(url,"_blank",$this.attr("title")||$this.text(),options);return false})})},multLookup:function(){return this.each(function(){var $this=$(this),args={};$this.click(function(event){var $unitBox=$this.parents(".unitBox:first");$unitBox.find("[name='"+$this.attr("multLookup")+"']").filter(":checked").each(function(){var _args=bee.jsonEval($(this).val());for(var key in _args){var value=args[key]?args[key]+",":"";args[key]=value+_args[key]}});if($.isEmptyObject(args)){alertMsg.error($this.attr("warn")||bee.msg("alertSelectMsg"));return false}$.bringBack(args)})})},suggest:function(){var op={suggest$:"#suggest",suggestShadow$:"#suggestShadow"};var selectedIndex=-1;return this.each(function(){var $input=$(this).attr("autocomplete","off").keydown(function(event){if(event.keyCode==bee.keyCode.ENTER&&$(op.suggest$).is(":visible")){return false}});var suggestFields=$input.attr("suggestFields").split(",");function _show(event){var offset=$input.offset();var iTop=offset.top+this.offsetHeight;var $suggest=$(op.suggest$);if($suggest.size()==0){$suggest=$('<div id="suggest"></div>').appendTo($("body"))}$suggest.css({left:offset.left+"px",top:iTop+"px"}).show();_lookup=$.extend(_lookup,{currentGroup:$input.attr("lookupGroup")||"",suffix:$input.attr("suffix")||"",$target:$input,pk:$input.attr("lookupPk")||"id",$callback:null});var url=unescape($input.attr("suggestUrl")).replaceTmById($(event.target).parents(".unitBox:first"));url=unescape($input.attr("suggestUrl")).replaceTmById($(event.target).parents("form:first"));if(!url.isFinishedTm()){alertMsg.error($input.attr("warn")||bee.msg("alertSelectMsg"));return false}var postData={};postData[$input.attr("postField")||"inputValue"]=$input.val();bee.PostData(url,postData,function(result){var html="";$.each(result,function(i){var liAttr="",liLabel="";for(var i=0;i<suggestFields.length;i++){var str=this[suggestFields[i]];if(str){if(liLabel){liLabel+="-"}liLabel+=str}}for(var key in this){if(liAttr){liAttr+=","}liAttr+=key+":'"+this[key]+"'"}html+='<li lookupAttrs="'+liAttr+'">'+liLabel+"</li>"});var $lis=$suggest.html("<ul>"+html+"</ul>").find("li");var $container=$("#container");var cheight=$container.offset().top+$container.height();if($suggest.offset().top+$suggest.height()>cheight){$suggest.css("top",$suggest.offset().top-$suggest.height()-$input.height()+"px")}$lis.hoverClass("selected").click(function(){_select($(this))});if($lis.size()==1&&event.keyCode!=bee.keyCode.BACKSPACE){_select($lis.eq(0))}else{if($lis.size()==0){var jsonStr="";for(var i=0;i<suggestFields.length;i++){if(_util.lookupField(suggestFields[i])==event.target.name){break}if(jsonStr){jsonStr+=","}jsonStr+=suggestFields[i]+":''"}jsonStr="{"+_lookup.pk+":'',"+jsonStr+"}";$.bringBackSuggest(bee.jsonEval(jsonStr))}}});$(document).bind("click",_close);return false}function _select($item){var jsonStr="{"+$item.attr("lookupAttrs")+"}";$.bringBackSuggest(bee.jsonEval(jsonStr))}function _close(){$(op.suggest$).html("").hide();selectedIndex=-1;$(document).unbind("click",_close)}$input.focus(_show).click(_show).keyup(function(event){var $items=$(op.suggest$).find("li");switch(event.keyCode){case bee.keyCode.ESC:case bee.keyCode.TAB:case bee.keyCode.SHIFT:case bee.keyCode.HOME:case bee.keyCode.END:case bee.keyCode.LEFT:case bee.keyCode.RIGHT:break;case bee.keyCode.ENTER:_close();break;case bee.keyCode.DOWN:if(selectedIndex>=$items.size()-1){selectedIndex=-1}else{selectedIndex++}break;case bee.keyCode.UP:if(selectedIndex<0){selectedIndex=$items.size()-1}else{selectedIndex--}break;default:_show(event)}$items.removeClass("selected");if(selectedIndex>=0){var $item=$items.eq(selectedIndex).addClass("selected");_select($item)}})})},itemDetail:function(){return this.each(function(){var $table=$(this).css("clear","both"),$tbody=$table.find("tbody");$('<input type="hidden" name="bee_itemNum" value="0"/>').insertBefore($table);var noopFlag=$table.hasClass("protect");var fields=[];if(!noopFlag){$(":input",$tbody).live("keydown",function(e){if(e.which==bee.keyCode.ENTER){var $box=$(this).parents(".unitBox:first");var inputs=$(":text",$box).not("[readonly]");var idx=inputs.index(this);if($(this).hasClass("required")&&$(this).val().trim()==""){return}if(idx==inputs.length-1){var nextBox=$box.next();if(nextBox.length==1){var nextinputs=nextBox.find(":text").not("[readonly]").not("[suggesturl]");if(nextinputs.length>0){$(nextinputs[0]).focus()}}else{var $btnAdd=$box.parents(".page:first").find(".addButton");if($btnAdd.length==1){$btnAdd.trigger("click")}}}else{$(inputs[idx+1]).focus()}return false}})}$table.find("tr:first th[type]").each(function(i){var $th=$(this);var field={type:$th.attr("type")||"text",patternDate:$th.attr("format")||"yyyy-MM-dd",name:$th.attr("name")||"",defaultVal:$th.attr("defaultVal")||"",size:$th.attr("size")||"12",enumUrl:$th.attr("enumUrl")||"",lookupGroup:$th.attr("lookupGroup")||"",lookupUrl:$th.attr("lookupUrl")||"",lookupPk:$th.attr("lookupPk")||"id",suggestUrl:$th.attr("suggestUrl"),suggestFields:$th.attr("suggestFields"),postField:$th.attr("postField")||"",fieldClass:$th.attr("fieldClass")||"",fieldAttrs:$th.attr("fieldAttrs")||""};fields.push(field)});$tbody.find("a.btnDel").click(function(){if(noopFlag){return}var $btnDel=$(this);if($btnDel.is("[href^=javascript:]")){$btnDel.parents("tr:first").remove();initSuffix($tbody);return false}function delDbData(){$.ajax({type:"POST",dataType:"json",url:$btnDel.attr("href"),cache:false,success:function(){$btnDel.parents("tr:first").remove();initSuffix($tbody)},error:bee.ajaxError})}if($btnDel.attr("title")){alertMsg.confirm($btnDel.attr("title"),{okCall:delDbData})}else{delDbData()}return false});var $buttonContent=null;if(!noopFlag){$buttonContent=$('<div class="topFormBar"><ul></ul></div>').insertBefore($table).find("ul")}var addButTxt=$table.attr("addButton")||"Add New";if(addButTxt&&!noopFlag){var $addBut=$buttonContent.append('<li><a class="button addButton"><span>'+addButTxt+"</span></a></li>").find("a");var $rowNum=$('<input type="hidden" name="bee_rowNum" class="textInput" style="margin:2px;" value="1" size="2"/>').insertBefore($table);var trTm="";$addBut.click(function(){if(!trTm){trTm=trHtml(fields)}var $tr=$(trTm);$tr.appendTo($tbody).initUI().find("a.btnDel").click(function(){$(this).parents("tr:first").remove();initSuffix($tbody);return false});initSuffix($tbody);$(":text:first",$tr).focus().select()})}var $tfoot=$("tfoot",$table);if($tfoot.length){var footFields=[];$("tr:first td[tvalue]",$tfoot).each(function(i){var $td=$(this);var tvalue=$td.attr("tvalue");var rvalue=tvalue.substring(tvalue.indexOf("{")+1,tvalue.indexOf("}"));rvalue=rvalue.replace(/\[(.*?)\]/g,"items[#index#].$1");var footField={target:$td,tvalue:tvalue,rvalue:rvalue,name:tvalue.substring(tvalue.indexOf("{"),tvalue.indexOf("}")+1)};footFields.push(footField)});$(":text",$tbody).live("blur",function(){var $tr=$(this).parent().parent();refreshComputerField($tr);refreshFootComputerField()})}function refreshComputerField(trParent){var $computerField=trParent.find(".computerField");if($computerField.length){var txtname=$computerField.attr("name");txtname=txtname.substring(0,txtname.indexOf("."));var txtvalue=$computerField.attr("tvalue");txtvalue=txtvalue.replace(/\[(.*?)\]/g,txtname+".$1");$computerField.val(computeValue(trParent,txtvalue).toString().formatNumber(2))}}function refreshFootComputerField(){var trs=$tbody.find(">tr");$(footFields).each(function(){var field=this;var total=0;trs.each(function(i){var txtname=field.rvalue.replaceAll("#index#",i);total+=computeValue($(this),txtname)});if(total>0){total=total.toString().formatNumber(2)}field.target.text(field.tvalue.replace(field.name,total))})}function computeValue(trParent,expression){if(expression.indexOf("*")<0){var txtname=expression.replaceForId();var $txt=trParent.find("[name="+txtname+"]");return parseFloat($txt.val())}else{var expression=expression.replaceForId();var index=expression.indexOf("*");var txtname1=expression.substring(0,index);var txtname2=expression.substring(index+1,expression.length);var $txt1=trParent.find("[name="+txtname1+"]");var $txt2=trParent.find("[name="+txtname2+"]");return parseFloat($txt1.val()*$txt2.val())}}function multiAdd(args){for(var key in args){var trTm=trHtml(fields);var $tr=$(trTm);$tr.find(":input").each(function(){var $input=$(this),inputName=$input.attr("name");for(var item in args[key]){var name=(_lookup.pk==item)?_util.lookupPk(item):_util.lookupField(item);if(name==inputName){$input.val(args[key][item]);break}}});$tr.find("a").each(function(){var $this=$(this);var $thisName=$this.attr("name");var $thisText=$this.attr("tvalue");if(!$thisName){return}for(var item in args[key]){var name=(_lookup.pk==item)?_util.lookupPk(item):_util.lookupField(item);name=name.replaceForId();$thisText=$thisText.replaceAll(name,args[key][item]);$thisName=$thisName.replaceAll(name,args[key][item])}$this.text($thisText);$this.attr("href",$thisName)});$tr.appendTo($tbody).initUI().find("a.btnDel").click(function(){$(this).parents("tr:first").remove();initSuffix($tbody);return false})}initSuffix($tbody)}var clearButTxt=$table.attr("clearButton");if(clearButTxt&&!noopFlag){var $clearBut=$('<li><a class="button"><span>'+clearButTxt+"</span></a></li>");$buttonContent.append($clearBut);$clearBut.click(function(){$tbody.empty()})}var multiAddButTxt=$table.attr("multiAddButton");var mulitAddUrl=$table.attr("multiAddUrl");if(multiAddButTxt&&!noopFlag){var $multiAddBut=$('<li><a class="button"><span>'+multiAddButTxt+"</span></a></li>");$buttonContent.append($multiAddBut);$multiAddBut.click(function(){_lookup=$.extend(_lookup,{$callback:multiAdd,currentGroup:$table.attr("itemGroup")});var options={mask:true,width:860,height:420,maxable:true};var url=unescape(mulitAddUrl).replaceTmById($(this).parents("form:first"));if(!url.isFinishedTm()){alertMsg.error(bee.msg("alertSelectMsg"));return false}$.pdialog.open(url,"_blank",multiAddButTxt,options);return false})}initSuffix($tbody);var trs=$tbody.find(">tr");trs.each(function(){refreshComputerField($(this))});refreshFootComputerField()});function initSuffix($tbody){var trs=$tbody.find(">tr");var $itemNum=$tbody.parents(".page:first").find("input[name=bee_itemNum]");if($itemNum.length){$itemNum.val(trs.length)}trs.each(function(i){$(":input, a.btnLook, span, a",this).each(function(){var $this=$(this),name=$this.attr("name"),val=$this.val();if(name){$this.attr("name",name.replaceSuffix(i))}var lookupGroup=$this.attr("lookupGroup");if(lookupGroup){$this.attr("lookupGroup",lookupGroup.replaceSuffix(i))}var suffix=$this.attr("suffix");if(suffix){$this.attr("suffix",suffix.replaceSuffix(i))}if(!$this.is("select")){var text=$this.text();if(text){$this.text(text.replaceSuffix(i))}}var href=$this.attr("href");if(href){$this.attr("href",href.replaceSuffix(i))}var max=$this.attr("max");if(max){$this.attr("max",max.replaceSuffix(i))}var max=$this.attr("tvalue");if(max){$this.attr("tvalue",max.replaceSuffix(i))}var max=$this.attr("id");if(max){$this.attr("id",max.replaceSuffix(i))}var max=$this.attr("suggesturl");if(max){$this.attr("suggesturl",max.replaceSuffix(i))}if(val&&val.indexOf("#index#")>=0){$this.val(val.replace("#index#",i+1))}if($this.is("span")){$this.html($this.html().replaceSuffix(i+1))}})})}function tdHtml(field){var html="",suffix="";if(field.name.endsWith("[#index#]")){suffix="[#index#]"}else{if(field.name.endsWith("[]")){suffix="[]"}}var suffixFrag=suffix?' suffix="'+suffix+'" ':"";var attrFrag="";if(field.fieldAttrs){var attrs=bee.jsonEval(field.fieldAttrs);for(var key in attrs){attrFrag+=key+'="'+attrs[key]+'"'}}switch(field.type){case"del":html='<a href="javascript:void(0)" class="btnDel '+field.fieldClass+'">删除</a>';break;case"lookup":var suggestFrag="";if(field.suggestFields){suggestFrag='autocomplete="off" lookupGroup="'+field.lookupGroup+'"'+suffixFrag+' suggestUrl="'+field.suggestUrl+'" suggestFields="'+field.suggestFields+'" postField="'+field.postField+'"'}html='<input type="hidden" name="'+field.lookupGroup+"."+field.lookupPk+suffix+'"/><input type="text" name="'+field.name+'"'+suggestFrag+' lookupPk="'+field.lookupPk+'" size="'+field.size+'" class="'+field.fieldClass+'"/><a class="btnLook" href="'+field.lookupUrl+'" lookupGroup="'+field.lookupGroup+'" '+suggestFrag+' lookupPk="'+field.lookupPk+'" title="查找选择">查找选择</a>';break;case"sugguest":var suggestFrag="";if(field.suggestFields){suggestFrag='autocomplete="off" lookupGroup="'+field.lookupGroup+'"'+suffixFrag+' suggestUrl="'+field.suggestUrl+'" suggestFields="'+field.suggestFields+'" postField="'+field.postField+'"'}html='<input type="hidden" name="'+field.lookupGroup+"."+field.lookupPk+suffix+'"/><input type="text" name="'+field.name+'"'+suggestFrag+' lookupPk="'+field.lookupPk+'" size="'+field.size+'" class="'+field.fieldClass+'"/>';break;case"attach":html='<input type="hidden" name="'+field.lookupGroup+"."+field.lookupPk+suffix+'"/><input type="text" name="'+field.name+'" size="'+field.size+'" readonly="readonly" class="'+field.fieldClass+'"/><a class="btnAttach" href="'+field.lookupUrl+'" lookupGroup="'+field.lookupGroup+'" '+suggestFrag+' lookupPk="'+field.lookupPk+'" width="560" height="300" title="查找选择">查找选择</a>';break;case"enum":$.ajax({type:"POST",dataType:"json",async:false,url:field.enumUrl,data:{inputName:field.name},success:function(json){if(!json.status){if(json.message&&alertMsg){alertMsg.error(json.message)}}else{html=json.result}}});break;case"date":html='<input type="text" name="'+field.name+'" value="'+field.defaultVal+'" class="date '+field.fieldClass+'" format="'+field.patternDate+'" size="'+field.size+'"/><a class="inputDateButton" href="javascript:void(0)">选择</a>';break;case"label":html="<span>"+field.defaultVal+"</span>";break;case"link":html='<a name="'+field.name+'" tvalue="'+field.defaultVal+'" class="'+field.fieldClass+'" '+attrFrag+"></a>";break;default:html='<input type="text" name="'+field.name+'" value="'+field.defaultVal+'" size="'+field.size+'" class="'+field.fieldClass+'" '+attrFrag+"/>";break}return"<td>"+html+"</td>"}function trHtml(fields){var html="";$(fields).each(function(){html+=tdHtml(this)});return'<tr class="unitBox">'+html+"</tr>"}},selectedTodo:function(){function _getIds(selectedIds,targetType){var ids="";var $box=targetType=="dialog"?$.pdialog.getCurrent():navTab.getCurrentPanel();$box.find("input:checked").filter("[name='"+selectedIds+"']").each(function(i){var val=$(this).val();ids+=i==0?val:","+val});return ids}return this.each(function(){var $this=$(this);var selectedIds=$this.attr("rel")||"ids";var postType=$this.attr("postType")||"map";$this.click(function(){var ids=_getIds(selectedIds,$this.attr("targetType"));if(!ids){alertMsg.error($this.attr("warn")||bee.msg("alertSelectMsg"));return false}function _doPost(){$.ajax({type:"POST",url:$this.attr("href"),dataType:"json",cache:false,data:function(){if(postType=="map"){return $.map(ids.split(","),function(val,i){return{name:selectedIds,value:val}})}else{var _data={};_data[selectedIds]=ids;return _data}}(),success:navTabAjaxDone,error:bee.ajaxError})}var title=$this.attr("title");if(title){alertMsg.confirm(title,{okCall:_doPost})}else{_doPost()}return false})})}})})(jQuery);(function(b){var e,f,d;b.fn.extend({contextMenu:function(k,h){var j=b.extend({shadow:true,bindings:{},ctrSub:null},h);if(!e){e=b('<div id="contextmenu"></div>').appendTo("body").hide()}if(!f){f=b('<div id="contextmenuShadow"></div>').appendTo("body").hide()}d=d||[];d.push({id:k,shadow:j.shadow,bindings:j.bindings||{},ctrSub:j.ctrSub});var g=d.length-1;b(this).bind("contextmenu",function(l){c(g,this,l,j);return false});return this}});function c(j,h,l,g){var n=d[j];var k=b(bee.frag[n.id]);k.find("li").hoverClass();e.html(k);b.each(n.bindings,function(q,p){b("[rel='"+q+"']",e).bind("click",function(r){a();p(b(h),b("#"+n.id))})});var o=l.pageX;var m=l.pageY;if(b(window).width()<o+e.width()){o-=e.width()}if(b(window).height()<m+e.height()){m-=e.height()}e.css({left:o,top:m}).show();if(n.shadow){f.css({width:e.width(),height:e.height(),left:o+3,top:m+3}).show()}b(document).one("click",a);if(b.isFunction(n.ctrSub)){n.ctrSub(b(h),b("#"+n.id))}}function a(){e.hide();f.hide()}})(jQuery);(function(b){b.setRegional("datepicker",{dayNames:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]});b.fn.getDayStr=function(d,c){var e=new a(d,c);return e.getDayStr()};b.fn.datepicker=function(g){var f={box$:"#calendar",year$:"#calendar [name=year]",month$:"#calendar [name=month]",tmInputs$:"#calendar .time :text",hour$:"#calendar .time .hh",minute$:"#calendar .time .mm",second$:"#calendar .time .ss",tmBox$:"#calendar .tm",tmUp$:"#calendar .time .up",tmDown$:"#calendar .time .down",close$:"#calendar .close",calIcon$:"a.inputDateButton",main$:"#calendar .main",days$:"#calendar .days",dayNames$:"#calendar .dayNames",clearBut$:"#calendar .clearBut",okBut$:"#calendar .okBut",body$:"#calendar .body"};function h(k){var j=b(f.tmBox$);j.removeClass("hh").removeClass("mm").removeClass("ss");if(k){j.addClass(k);b(f.tmInputs$).removeClass("slt").filter("."+k).addClass("slt")}}function c(k,j){b(f.tmBox$).find("."+j+" li").each(function(){var l=b(this);l.click(function(){k.val(l.text())})})}function e(j){if(!((j.keyCode>=48&&j.keyCode<=57)||(j.keyCode==bee.keyCode.DELETE||j.keyCode==bee.keyCode.BACKSPACE))){return false}}function d(o,l){var j=parseInt(o.val()),m=parseInt(o.attr("start"))||0,k=parseInt(o.attr("end"));var n=parseInt(o.attr("step")||1);if(l==1){if(j<=k-n){o.val(j+n)}}else{if(l==-1){if(j>=m+n){o.val(j-n)}}else{if(j>k){o.val(k)}else{if(j<m){o.val(m)}}}}}return this.each(function(){var l=b(this);var m=new a(l.val(),g);function j(q){var s=q.getDayStr();var u=b(f.days$).html(s).find("dd");u.not(".disabled").click(function(){var w=b(this);if(!q.hasTime()){l.val(q.formatDate(q.changeDay(w.attr("day"),w.attr("chMonth")))).change();k()}else{u.removeClass("slt");w.addClass("slt")}});if(!q.hasDay()){b(f.body$).addClass("noday")}if(!q.hasDate()){b(f.main$).addClass("nodate")}if(q.hasTime()){var n=q.getDateWrap();b("#calendar .time").show();var p=b(f.hour$).val(n.hour).focus(function(){h("hh")});var r=parseInt(n.minute/q.opts.mmStep)*q.opts.mmStep;var v=b(f.minute$).val(r).attr("step",q.opts.mmStep).focus(function(){h("mm")});var t=b(f.second$).val(q.hasSecond()?n.second:0).attr("step",q.opts.ssStep).focus(function(){h("ss")});p.add(v).add(t).click(function(){return false});c(p,"hh");c(v,"mm");c(t,"ss");b(f.box$).click(function(){h()});var o=b(f.tmInputs$);o.keydown(e).each(function(){var w=b(this);w.keyup(function(){d(w,0)})});b(f.tmUp$).click(function(){o.filter(".slt").each(function(){d(b(this),1)})});b(f.tmDown$).click(function(){o.filter(".slt").each(function(){d(b(this),-1)})});if(!q.hasHour()){p.attr("disabled",true)}if(!q.hasMinute()){v.attr("disabled",true)}if(!q.hasSecond()){t.attr("disabled",true)}}}function k(){b(f.box$).remove();b(document).unbind("click",k)}l.click(function(o){k();var q=new a(l.val(),g);var r=l.offset();var s=r.top+this.offsetHeight;b(bee.frag.calendarFrag).appendTo("body").css({left:r.left+"px",top:s+"px"}).show().click(function(z){z.stopPropagation()});(b.fn.bgiframe&&b(f.box$).bgiframe());var p="";b.each(b.regional.datepicker.dayNames,function(A,z){p+="<dt>"+z+"</dt>"});b(f.dayNames$).html(p);var n=q.getDateWrap();var u=b(f.year$);var w=q.getMinDate().getFullYear();var v=q.getMaxDate().getFullYear();for(y=w;y<=v;y++){u.append('<option value="'+y+'"'+(n.year==y?'selected="selected"':"")+">"+y+"</option>")}var t=b(f.month$);b.each(b.regional.datepicker.monthNames,function(B,A){var z=B+1;t.append('<option value="'+z+'"'+(n.month==z?'selected="selected"':"")+">"+A+"</option>")});j(q);u.add(t).change(function(){q.changeDate(u.val(),t.val());j(q)});var x=b(f.box$).outerHeight(true);if(s>x&&s>b(window).height()-x){b(f.box$).css("top",r.top-x)}b(f.close$).click(function(){k()});b(f.clearBut$).click(function(){l.val("");k()});b(f.okBut$).click(function(){var A=b(f.days$).find("dd.slt");if(A.hasClass("disabled")){return false}var z=q.changeDay(A.attr("day"),A.attr("chMonth"));if(q.hasTime()){z.setHours(parseInt(b(f.hour$).val()));z.setMinutes(parseInt(b(f.minute$).val()));z.setSeconds(parseInt(b(f.second$).val()))}l.val(q.formatDate(z)).change();k()});b(document).bind("click",k);return false});l.parent().find(f.calIcon$).click(function(){l.trigger("click");return false})})};var a=function(e,d){this.opts=b.extend({pattern:"yyyy-MM-dd",minDate:"1900-01-01",maxDate:"2099-12-31",mmStep:1,ssStep:1},d);var c=new Date();this.opts.minDate=c.formatDateTm(this.opts.minDate);this.opts.maxDate=c.formatDateTm(this.opts.maxDate);this.sDate=e.trim()};b.extend(a.prototype,{get:function(c){return this.opts[c]},_getDays:function(d,c){return c==2?(d%4||!(d%100)&&d%400?28:29):(/4|6|9|11/.test(c)?30:31)},getDayStr:function(){var c=this.getDateWrap();var f=this.getMinDate();var d=this.getMaxDate();var k=new Date(c.year,c.month-1,1);var j=k.getDay();var g="";if(j>0){k.setMonth(k.getMonth()-1);var h=this.getDateWrap(k);for(var l=h.days-j+1;l<=h.days;l++){var m=new Date(c.year,c.month-2,l);var e=(m>=f&&m<=d)?"":"disabled";g+='<dd class="other '+e+'" chMonth="-1" day="'+l+'">'+l+"</dd>"}}for(var l=1;l<=c.days;l++){var m=new Date(c.year,c.month-1,l);var e=(m>=f&&m<=d)?"":"disabled";if(l==c.day){g+='<dd class="slt '+e+'" day="'+l+'">'+l+"</dd>"}else{g+='<dd class="'+e+'" day="'+l+'">'+l+"</dd>"}}for(var l=1;l<=42-j-c.days;l++){var m=new Date(c.year,c.month,l);var e=(m>=f&&m<=d)?"":"disabled";g+='<dd class="other '+e+'" chMonth="1" day="'+l+'">'+l+"</dd>"}return g},_minMaxDate:function(e){var d=e.split("-").length-1;var c="y-M-d";if(d==1){c="y-M"}else{if(d==0){c="y"}}return e.parseDate(c)},getMinDate:function(){return this._minMaxDate(this.opts.minDate)},getMaxDate:function(){var f=this.opts.maxDate;var d=f.split("-").length-1;var c=this._minMaxDate(f);if(d<2){var e=this._getDays(c.getFullYear(),c.getMonth()+1);c.setDate(e);if(d==0){c.setMonth(11)}}return c},getDateWrap:function(d){if(!d){d=this.parseDate(this.sDate)||new Date()}var f=d.getFullYear();var c=d.getMonth()+1;var e=this._getDays(f,c);return{year:f,month:c,day:d.getDate(),hour:d.getHours(),minute:d.getMinutes(),second:d.getSeconds(),days:e,date:d}},changeDate:function(g,c,f){var e=new Date(g,c-1,f||1);this.sDate=this.formatDate(e);return e},changeDay:function(c,e){if(!e){e=0}var d=this.getDateWrap();return this.changeDate(d.year,d.month+parseInt(e),c)},parseDate:function(c){if(!c){return null}return c.parseDate(this.opts.pattern)},formatDate:function(c){return c.formatDate(this.opts.pattern)},hasDay:function(){return this.opts.pattern.indexOf("d")!=-1},hasHour:function(){return this.opts.pattern.indexOf("H")!=-1},hasMinute:function(){return this.opts.pattern.indexOf("m")!=-1},hasSecond:function(){return this.opts.pattern.indexOf("s")!=-1},hasTime:function(){return this.hasHour()||this.hasMinute()||this.hasSecond()},hasDate:function(){var d=["y","M","d","E"];for(var c=0;c<d.length;c++){if(this.opts.pattern.indexOf(d[c])!=-1){return true}}return false}})})(jQuery);jQuery.fn.extend({OpenDiv:function(m){var n={left:0,top:0,opacity:0.7,ceiling:"ceiling"};$.extend(n,m);var d,f;d=window.screen.availWidth;if(window.screen.availHeight>document.body.scrollHeight){f=window.screen.availHeight}else{f=document.body.scrollHeight+20}$("#background").show();var a=this.width();var j=this.height();a=parseInt(a);j=parseInt(j);var c=$.PageSize().Width;var l=$.PageSize().Height;var e=$.ScrollPosition().Left;var k=$.ScrollPosition().Top;var g=n.top;var b=n.left;var h=$("#"+n.ceiling);if(g==0){if(h.length==1){g=h.offset().top+h.height()}else{g=k+(l/2)-(j/2)}}if(b==0){if(h.length==1){b=h.offset().left}else{b=e+(c/2)-(a/2)}}if(b+a>c){b=c-a}if(g+j>l){g=l-j}this.css("position","fixed");this.css("z-index","10001");this.css("background","#fff");this.css("left",b+"px");this.css("top",g+"px");if($.browser.mozilla){this.show();return}this.fadeIn("fast")},CloseDiv:function(){if($.browser.mozilla){this.hide()}else{this.fadeOut("fast")}$("#background").hide()}});$.extend({PageSize:function(){var b=0;var a=0;b=window.innerWidth!=null?window.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body!=null?document.body.clientWidth:null;a=window.innerHeight!=null?window.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body!=null?document.body.clientHeight:null;return{Width:b,Height:a}},ScrollPosition:function(){var b=0,a=0;if($.browser.mozilla){b=window.pageYOffset;a=window.pageXOffset}else{if($.browser.msie){b=document.documentElement.scrollTop;a=document.documentElement.scrollLeft}else{if(document.body){b=document.body.scrollTop;a=document.body.scrollLeft}}}return{Top:b,Left:a}}});(function(a){a.extend(a.fn,{selection:function(f,l){var r={multiSelect:true,maxSelect:5,includeParent:true,callback:null,tipInfo:"已选择的洲或国家(最多选择5个国家或一个洲)"};a.extend(r,f);var n=false;var g=o();var b=a(".Contentbox1",g);var c=a(".Menubox1",g);var p=a(".checked >ul",g);var j=[];var q=[];var h=[];var e=function(){g.CloseDiv();var s=[];var t=[];a(":checkbox",g).each(function(){var u=a(this);if(u.attr("checked")){s.push(u.attr("name"));t.push(u.val())}});r.callback(s,t)};if(l==undefined){a("li",p).each(function(){$li=a(this);h.push($li.attr("tvalue"))})}else{h=l.split(",")}c.html("");b.html("");var m=this;var k=0;j.push("<ul>");a(">ul >li",m).each(function(){var s=a(this);j.push("<li id='two",k,"'");q.push("<div id='con_two",k,"'");if(k==0){j.push(" class='hover'");q.push(" class='hover'")}else{q.push(" style='display:none'")}j.push(">",s.attr("tname"),"</li>");q.push(">");if(r.includeParent){q.push("<span style='color:black'>","<input parent='true' type='checkbox' ");if(a.inArray(s.attr("tvalue"),h)!=-1){q.push("checked ");n=true}q.push("name='",s.attr("tname"),"' value='",s.attr("tvalue"),"'/>&nbsp;");q.push(s.attr("tname"),"</span>")}a(">ul >li",s).each(function(){var t=a(this);q.push("<span style='color:black'>","<input type='checkbox' ");if(a.inArray(t.attr("tvalue"),h)!=-1){q.push("checked ")}q.push("name='",t.attr("tname"),"' value='",t.attr("tvalue"),"'/>&nbsp;");q.push(t.attr("tname"),"</span>")});q.push("</div>");b.append(q.join(""));q=[];k+=1});j.push("</ul>");c.append(j.join(""));if(r.multiSelect){d("",false)}else{d(h[0],false)}a("#countryConfirm",g).one("click",e);g.OpenDiv(f);a(".Menubox1 >ul >li",g).click(function(){a(this).addClass("hover");a(this).siblings().removeClass("hover");var s=a("#con_"+a(this).attr("id"));s.show();s.siblings().hide()});a(":checkbox",g).click(function(){var s=a(this);var u=[];var t=s.attr("parent")=="true";a(":checkbox",g).each(function(){var v=a(this);if(v.attr("checked")){u.push(v.val())}});if(!t&&r.maxSelect<u.length){s.removeAttr("checked");return}var t=s.attr("parent")=="true";d(s.val(),t)});function d(u,t){var s=[];a(":checkbox",g).each(function(){var w=a(this);var v=w.val()==u;if(w.attr("checked")){if(n&&!v){w.removeAttr("checked");return}if(t&&!v){w.removeAttr("checked");return}if(!r.multiSelect&&!v){w.removeAttr("checked");return}s.push("<li tvalue='",w.val(),"'><a></a>");s.push(w.attr("name"),"</li>")}});p.html("");p.append(s.join(""));n=t;a("li",p).click(function(){$checkli=a(this);a(":checkbox",g).each(function(){var v=a(this);if(v.attr("checked")){if(v.val()==$checkli.attr("tvalue")){v.removeAttr("checked")}}});d(false,"")})}function o(){var s=a("#selectionBox");if(s.length==0){var t=[];t.push("<div id='selectionBox' style='display:none'>","<div class='top_one'>","	<span><a id='countryConfirm' href='#'>[ 确定 ]</a></span>{0}</div>","	<div class='checked'><ul></ul>","	<div class='clear'></div>","</div>","<div id='SelectionTab'>","	<div class='Menubox1'></div>","	<div class='Contentbox1'>","		<div class='clear'></div>","	</div>","</div>","<div class='clear'></div>","</div>");a(document.body).append(t.join("").replace("{0}",r.tipInfo));s=a("#selectionBox")}return s}}})})(jQuery);(function(c){var b=[];var a=function(d){c.each(b,function(e){if(b[e]!=d){if(!c("#"+b[e])[0]){c("#op_"+b[e]).remove()}else{c("#op_"+b[e]).css({height:"",width:""}).hide()}c(document).unbind("click",a)}})};c.extend(c.fn,{comboxValue:function(){var g=c(this);var d=g.val();var f=g.attr("svalue");var e=false;c("option",g).each(function(){var h=c(this);if(f==h[0].value){e=true}});if(e||d==null){d=f}return d},comboxSelect:function(d){var e=c.extend({selector:">a"},d);return this.each(function(){var g=c(this);var f=c(e.selector,g);b.push(g.attr("id"));c(e.selector,g).click(function(){var h=c("#op_"+g.attr("id"));if(h.is(":hidden")){if(h.height()>300){h.css({height:"300px",overflow:"scroll"})}var j=g.offset().top+g[0].offsetHeight;if(j+h.height()>c(window).height()-20){j=c(window).height()-20-h.height()}h.css({top:j,left:g.offset().left}).show();a(g.attr("id"));c(document).click(a)}else{c(document).unbind("click",a);a()}return false});c("#op_"+g.attr("id")).find(">li").comboxOption(f,g)})},comboxOption:function(d,e){return this.each(function(){c(">a",this).click(function(g){var j=c(this);if(e.hasClass("multiple")){var l=c(":text",e);if(j.attr("value")==""){j.parent().parent().find(".selected").removeClass("selected");j.addClass("selected");l.val("");d.text(j.text())}else{j.toggleClass("selected");var k="";var h="";j.parent().parent().find(".selected").each(function(){var m=c(this);if(m.attr("value")!=""){k+=m.text()+",";h+=m.attr("value")+","}else{m.removeClass("selected")}});k=k.substring(0,k.length-1);h=h.substring(0,h.length-1);l.val(h);d.text(k);g.stopPropagation()}}else{j.parent().parent().find(".selected").removeClass("selected");j.addClass("selected");var f=j.attr("value");var l=c("select",e);d.text(j.text());l.val(f).attr("svalue",f).trigger("refChange").trigger("change")}})})},combox:function(){var d=[];c.each(b,function(e){if(c("#"+b[e])[0]){d.push(b[e])}else{c("#op_"+b[e]).remove()}});b=d;return this.each(function(h){var l=c(this).removeClass("combox");var e=l.attr("name");var p=l.comboxValue();var o="";var f=l.attr("ref");var m=l.attr("refUrl")||"";var r=l.attr("multiple");var j=l.hasClass("readonly");var g=",,";if(p!=""){g=","+p;if(g.substring(g.length-1)!=","){g+=","}}var k=l.attr("id")||Math.round(Math.random()*10000000);var q='<ul class="comboxop" id="op_combox_'+k+'">';c("option",l).each(function(){var t=c(this);var s="";if(g.indexOf(","+t[0].value+",")>=0){s="selected";o+=t[0].text+","}q+='<li><a class="'+s+'" href="#" value="'+t[0].value+'">'+t[0].text+"</a></li>"});q+="</ul>";if(r){if(o.length>0){o=o.substring(0,o.length-1)}}else{l.val(p);o=c("option[value="+p+"]",l).text()}var n='<div class="combox '+(j?"readonly":"")+'"><div id="combox_'+k+'" class="select '+(r?"multiple":"")+'"'+(f?' ref="'+f+'"':"")+">";n+='<a href="javascript:" class="'+l.attr("class")+'" name="'+e+'" value="'+p+'">'+o+"</a></div></div>";c("body").append(q);l.after(n);if(r){c("div.select",l.next()).comboxSelect().append("<input type='text' name='"+e+"' value='"+p+"' style='display:none;'/>");l.remove()}else{if(j){c("div.select",l.next()).append(l)}else{c("div.select",l.next()).comboxSelect().append(l)}}if(f&&m){l.unbind("refChange").bind("refChange",function(s){var t=c("#"+f);if(t.size()==0){return false}bee.PostData(m.replace("{value}",escape(l.comboxValue())),{},function(v){var u="";if(v){c.each(v,function(z){var x=v[z].split("$");if(x.length>1){u+='<option value="'+x[0]+'">'+x[1]+"</option>"}})}var w=t.parents("div.combox:first");t.html(u).insertAfter(w);w.remove();t.combox().trigger("refChange").trigger("change")})})}})}})})(jQuery);function HeartBeat(){bee.PostData("/BeeMessage/UnreadCount.bee",null,function(a){if(a>0){$("#beeMessage").show().find("span").html(a).css("color","red")}else{$("#beeMessage").hide()}})}function toLogin(){$("#innerLogin").trigger("click")}function iframeCallback(b,d){var a=$(b),c=$("#callbackframe");if(!a.valid()){return false}if(c.size()==0){c=$("<iframe id='callbackframe' name='callbackframe' src='about:blank' style='display:none'></iframe>").appendTo("body")}if(!b.ajax){a.append('<input type="hidden" name="ajax" value="1" />')}b.target="callbackframe";_iframeResponse(c[0],d||bee.ajaxDone)}function _iframeResponse(a,d){var b=$(a),c=$(document);c.trigger("ajaxStart");b.bind("load",function(g){b.unbind("load");c.trigger("ajaxStop");if(a.src=="javascript:'%3Chtml%3E%3C/html%3E';"||a.src=="javascript:'<html></html>';"){return}var j=a.contentDocument||a.document;if(j.readyState&&j.readyState!="complete"){return}if(j.body&&j.body.innerHTML=="false"){return}var f;if(j.XMLDocument){f=j.XMLDocument}else{if(j.body){try{f=b.contents().find("body").text();f=bee.jsonEval(f)}catch(h){f=j.body.innerHTML}}else{f=j}}d(f)})}function reloadDialog(d){if(!d){var c=$.pdialog.getCurrent();d=$("form",c).attr("Id")}var b="#"+d;var a=$(b);if(a.valid()){$("input[name='pageNum']",a).val(1);$("input[name='recordCount']",a).val(0);$.pdialog.reload(a.attr("action"),{data:a.serializeArray()})}}function divLoad(c,a){var b=$(c);if(a){var d=a;d.ajaxUrl({type:"POST",url:b.attr("action"),data:b.serializeArray(),callback:function(){d.find("[layoutH]").layoutH()}})}return false}function ajaxTodo(url,callback){var formId=getCurrentFormId();var form="#"+formId;var $callback=callback;if(!$.isFunction($callback)){$callback=eval("("+callback+")")}$.ajax({type:"POST",url:url,dataType:"json",cache:false,success:function(data){if(data.status){if($.isFunction($callback)){$callback(data.result)}else{var refreshFlag=true;var formInNavTab=$(form,navTab.getCurrentPanel());if(formInNavTab.length){refreshFlag=!formInNavTab.hasClass("noRefresh");if(!refreshFlag){navTab.closeCurrentTab()}}if(refreshFlag){autoList(formId)}}alertMsg.correct("操作成功！")}else{alertMsg.error(data.message)}},error:bee.ajaxError})}function clearEmptyTr(d){var c=d.find("tbody");var b=c.find(">tr");var a=[];b.each(function(f){var e=true;$(":text.required",$(this)).each(function(g){if($(this).val()!=""){e=false}});if(e){a.push(this)}});$(a).each(function(e){$(this).remove()});b=c.find(">tr");if(b.length==0){return false}return true}function autoSave(d){if(!d){d=getCurrentFormId()}var b="#"+d;var a=$(b);if(a.valid()){var c=$("input[name=bee_itemNum]",a);if(c.length&&c.val()==0){alertMsg.error("无任何明细。");return}bee.PostData(a.attr("action"),a.serializeArray(),function(g){var f=true;var e=$(b,navTab.getCurrentPanel());if(e.length){f=!e.hasClass("noRefresh")}if(f){autoList(getCurrentFormId(),true);$.pdialog.closeCurrent()}else{navTab.closeCurrentTab()}alertMsg.correct("操作成功！")})}}function getCurrentFormId(a){$box=$(a);if($box.length==0){$box=$(navTab.getCurrentPanel())}return $("form",$box).attr("Id")}function autoList(d,a){if(!d){d=getCurrentFormId()}var c="#"+d;var b=$(c);if(b.length&&b.valid()){if(!a){$("input[name='pageNum']",b).val(1);$("input[name='recordCount']",b).val(0)}navTab.reload(b.attr("action"),{data:b.serializeArray()});return false}}function dialogJumpTo(b,e){var d=$.pdialog.getCurrent();var a=$("form",d);if(b==0){var c=$(e).siblings(":text");b=c.val()}$("input[name='pageNum']",a).val(b);$.pdialog.reload(a.attr("action"),{data:a.serializeArray()})}function autoJumpTo(c,f){var e=getCurrentFormId();var b="#"+e;var a=$(b);if(c==0){var d=$(f).siblings(":text");c=d.val()}$("input[name='pageNum']",a).val(c);navTab.reload(a.attr("action"),{data:a.serializeArray()});return false}function dwzExport(){function a(e){var d=e.attr("targetType")=="dialog"?$.pdialog.getCurrent():navTab.getCurrentPanel();var b=$("#pagerForm",d);var c=e.attr("href");window.location=c+(c.indexOf("?")==-1?"?":"&")+b.serialize()}return this.each(function(){var b=$(this);b.click(function(c){var d=b.attr("title");if(d){alertMsg.confirm(d,{okCall:function(){a(b)}})}else{a(b)}c.preventDefault()})})}function divSearch(c,a){var b=$(c);if(c.pageNum){c.pageNum.value=1}if(a){var d=$("#"+a);d.ajaxUrl({type:"POST",url:b.attr("action"),data:b.serializeArray(),callback:function(){d.find("[layoutH]").layoutH()}})}return false}function _getPagerForm(c,a){var b=$("Form",c).get(0);if(b){if(a.pageNum){b.pageNum.value=a.pageNum}if(a.numPerPage){b.numPerPage.value=a.numPerPage}if(a.orderField){b.orderField.value=a.orderField}if(a.orderDirection&&b.orderDirection){b.orderDirection.value=a.orderDirection}}return b}function dwzPageBreak(a){var f=$.extend({targetType:"navTab",rel:"",data:{pageNum:"",numPerPage:"",orderField:"",orderDirection:""},callback:null},a);var d=f.targetType=="dialog"?$.pdialog.getCurrent():navTab.getCurrentPanel();if(f.rel){var c=d.find("#"+f.rel);var b=_getPagerForm(c,f.data);if(b){c.ajaxUrl({type:"POST",url:$(b).attr("action"),data:$(b).serializeArray(),callback:function(){c.find("[layoutH]").layoutH()}})}}else{var b=_getPagerForm(d,f.data);var e=$(b).serializeArray();if(f.targetType=="dialog"){if(b){$.pdialog.reload($(b).attr("action"),{data:e,callback:f.callback})}}else{if(b){navTab.reload($(b).attr("action"),{data:e,callback:f.callback})}}}}function navTabPageBreak(b,a){dwzPageBreak({targetType:"navTab",rel:a,data:b})}function dialogPageBreak(b,a){dwzPageBreak({targetType:"dialog",rel:a,data:b})}function autoChangePageSize(e){var f=getCurrentFormId();var b;var d=$(e);var c="#"+f;var a=$(c);$("input[name='pageNum']",a).val(1);$("input[name='pageSize']",a).val(d.val());navTab.reload(a.attr("action"),{data:a.serializeArray(),navTabId:b});return false}function validShowAlertMsgError(c){var e=[];for(var b=0;c.errorList[b];b++){var a=c.errorList[b];e.push(a.message);c.settings.highlight&&c.settings.highlight.call(c,a.element,c.settings.errorClass,c.settings.validClass)}if(c.settings.unhighlight){for(var b=0,d=c.validElements();d[b];b++){c.settings.unhighlight.call(c,d[b],c.settings.errorClass,c.settings.validClass)}}if(c.errorList.length!=0){alertMsg.info(e.join("</br>"))}}function autoFill(b,a){b[0].reset();$(":input",b).each(function(){$this=$(this);var e=new String(a[$this.attr("name")]);e=e.toString();if(e.indexOf("/Date(")>=0&&e.indexOf("+")>0){var f=e.indexOf("+");var d=e.substring(6,f);var c=new Date();c.setTime(d);e=c.formatDate("yyyy-MM-dd HH:mm:ss")}if(e&&e!="undefined"&&e!="null"){switch(this.type){case"checkbox":if(e.indexOf($this.val())>=0){$this.attr("checked",e)}break;case"radio":if($this.val()==e){$this.attr("checked",e)}else{if($this.attr("checked")){$this.removeAttr("checked")}}break;case"hidden":case"password":case"textarea":case"text":case"select-one":$this.val(e);break}}})}function uploadifyQueueComplete(a){var b="The total number of files uploaded: "+a.uploadsSuccessful+"<br/>The total number of errors while uploading: "+a.uploadsErrored+"<br/>The total number of bytes uploaded: "+a.queueBytesUploaded+"<br/>The average speed of all uploaded files: "+a.averageSpeed;if(a.uploadsErrored){alertMsg.error(b)}else{alertMsg.correct(b)}}function uploadifySuccess(b,c,a){alert(c);alert(b);alert(a)}function uploadifyError(a,c,b){alertMsg.error(c+": "+b)}(function(a){a.extend(a.fn,{jBlindUp:function(b){var c=a.extend({duration:500,easing:"swing",call:function(){}},b);return this.each(function(){var d=a(this);a(this).animate({height:0},{step:function(){},duration:c.duration,easing:c.easing,complete:function(){d.css({display:"none"});c.call()}})})},jBlindDown:function(b){var c=a.extend({to:0,duration:500,easing:"swing",call:function(){}},b);return this.each(function(){var e=a(this);var d=(c.to>0)?c.to:a.effect.getDimensions(e[0]).height;e.animate({height:d},{step:function(){},duration:c.duration,easing:c.easing,complete:function(){e.css({display:""});c.call()}})})},jSlideUp:function(b){var c=a.extend({to:0,duration:500,easing:"swing",call:function(){}},b);return this.each(function(){var e=a(this);e.wrapInner("<div></div>");var d=(c.to>0)?c.to:a.effect.getDimensions(a(">div",e)[0]).height;e.css({overflow:"visible",position:"relative"});a(">div",e).css({position:"relative"}).animate({top:-d},{easing:c.easing,duration:c.duration,complete:function(){e.html(a(this).html())}});e.animate({height:0},{duration:c.duration,easing:c.easing,complete:function(){e.css({display:"none",height:""});c.call()}})})},jSlideDown:function(b){var c=a.extend({to:0,duration:500,easing:"swing",call:function(){}},b);return this.each(function(){var e=a(this);var d=(c.to>0)?c.to:a.effect.getDimensions(e[0]).height;e.wrapInner('<div style="top:-'+d+'px;"></div>');e.css({overflow:"visible",position:"relative",height:"0px"}).animate({height:d},{duration:c.duration,easing:c.easing,complete:function(){e.css({display:"",overflow:""});c.call()}});a(">div",e).css({position:"relative"}).animate({top:0},{easing:c.easing,duration:c.duration,complete:function(){e.html(a(this).html())}})})}});a.effect={getDimensions:function(c,g){var d=new a.effect.Rectangle;var f=a(c).css("display");var b=a(c).css("visibility");var e=a(c).height()==0?true:false;if(a(c).is(":hidden")){a(c).css({visibility:"hidden",display:"block"});if(e){a(c).css("height","")}if(a.browser.opera){refElement.focus()}}d.height=a(c).height();d.width=a(c).width();if(f=="none"){a(c).css({visibility:b,display:"none"});if(e){if(e){a(c).css("height","0px")}}}return d}};a.effect.Rectangle=function(){this.width=0;this.height=0;this.unit="px"}})(jQuery);(function(d){d.fn.jtip=function(g){var f=d.extend({},d.fn.jtip.defaults,g||{});e(f);d(this).mouseover(function(n){var m=d(this);if(m.is("a")&&(m.attr("target")=="tip"||m.attr("target")=="imgtip")){a=true;var j=unescape(m.attr("href")).replaceTmById(m.parents("form:first"));if(!j.isFinishedTm()){alertMsg.error(m.attr("warn"));return false}var l=m.data("url");if(l==j){var k=m.data("tip");if(k){c(n,k,f.opacity);return}}if(m.attr("target")=="tip"){d.ajax({type:"GET",url:j,data:null,global:false,cache:false,success:function(o){var p=bee.jsonEval(o);if(p.status!=undefined){if(!p.status){alertMsg.error(p.message)}else{c(n,p.result,f.opacity)}}else{m.data("url",j);m.data("tip",o);c(n,o,f.opacity)}},error:bee.ajaxError})}else{var h="<image src='"+j+"' height='200px'/>";c(n,h,f.opacity)}}else{this.selftip=m.attr("title");this.title="";if(this.selftip!=""){c(n,this.selftip,f.opacity)}}}).mouseout(function(){if(this.selftip){this.title=this.selftip}b.hide().children(":first").html("")}).mousemove(function(h){a=true;c(h)})};d.fn.jtip.defaults={maxwidth:300,opacity:0.8,background:"#DEDFDD",border:"#FEFFD4 solid 1px",contentcolor:"#000000",font:"12px verdana,arial,sans-serif"};var b=null;var a=false;function c(f,g,h){if(g){b.children(":first").html(g);b.css({opacity:h}).show()}var k=f.pageY+20;var j=f.pageX+10;if(d(window).width()<j+b.width()){j-=b.width()}if(d(window).height()<k+b.height()){k-=b.height()}b.css({top:(k)+"px",left:(j)+"px"})}function e(g){var f=d("#jq_bbf_tipdiv");if(f.length==0){f=[];f.push("<div id='jq_bbf_tipdiv' style='display:none;position:absolute;z-index:1001;max-width:");f.push(g.maxwidth);f.push("px;background:");f.push(g.background);f.push(";width:auto!important;width:auto;border:");f.push(g.border);f.push(";text-align:left;padding:3px;'><p style='margin:0;padding:0;color:");f.push(g.contentcolor);f.push(";font:");f.push(g.font);f.push(";'></p></div>");f=d(f.join("")).appendTo("body");d(window).mousemove(function(h){if(!a){b.hide()}a=false})}b=f;f=null}})(jQuery);(function(a){a.extend(a.fn,{jPanel:function(b){var c=a.extend({header:"panelHeader",headerC:"panelHeaderContent",content:"panelContent",coll:"collapsable",exp:"expandable",footer:"panelFooter",footerC:"panelFooterContent"},b);return this.each(function(){var o=a(this);var m=o.hasClass("close");var j=o.hasClass("collapse");var e=a(">div",o).addClass(c.content);var k=a(">h1",o).wrap('<div class="'+c.header+'"><div class="'+c.headerC+'"></div></div>');if(j){a('<a href=""></a>').addClass(m?c.exp:c.coll).insertAfter(k)}var h=a(">div:first",o);var l=a('<div class="'+c.footer+'"><div class="'+c.footerC+'"></div></div>').appendTo(o);var f=o.attr("defH")?o.attr("defH"):0;var n=o.attr("minH")?o.attr("minH"):0;if(m){e.css({height:"0px",display:"none"})}else{if(f>0){e.height(f+"px")}else{if(n>0){e.css("minHeight",n+"px")}}}if(!j){return}var d=a("a",h);var g=e.innerHeight()-6;if(n>0&&n>=g){f=n}else{f=g}h.click(function(){if(d.hasClass(c.exp)){e.jBlindDown({to:f,call:function(){d.removeClass(c.exp).addClass(c.coll);if(n>0){e.css("minHeight",n+"px")}}})}else{if(n>0){e.css("minHeight","")}if(n>=g){e.css("height",n+"px")}e.jBlindUp({call:function(){d.removeClass(c.coll).addClass(c.exp)}})}return false})})}})})(jQuery);(function(b){var a={cursor:"move",sortBoxs:"div.sortDrag, ul.sortDrag",replace:false,items:"> *",selector:"",zIndex:1000};var c={start:function(f,e,h,k){var g=this._createPlaceholder(e);var j=e.clone();var d=e.position();j.data("$sortBox",f).data("op",k).data("$item",e).data("$placeholder",g);j.addClass("sortDragHelper").css({position:"absolute",top:d.top,left:d.left,zIndex:k.zIndex,width:e.width()+"px",height:e.height()+"px"}).jDrag({selector:k.selector,drag:this.drag,stop:this.stop,event:h});e.before(g).before(j).hide();return false},drag:function(){var m=b(arguments[0]),f=m.data("$sortBox"),k=m.data("$placeholder");var j=f.find(m.data("op")["items"]).filter(":visible").filter(":not(.sortDragPlaceholder, .sortDragHelper)");var d=m.position(),e=j.eq(0).position();var n=c._getOverSortBox(m);if(n.length>0&&n[0]!=f[0]){k.appendTo(n);m.data("$sortBox",n)}else{for(var g=0;g<j.length;g++){var l=j.eq(g),h=l.position();if(d.top>h.top+10){l.after(k)}else{if(d.top<=h.top){l.before(k);break}}}}},stop:function(){var g=b(arguments[0]),e=g.data("$item"),f=g.data("$placeholder");var d=f.position();g.animate({top:d.top+"px",left:d.left+"px"},{complete:function(){if(g.data("op")["replace"]){$srcBox=e.parents(a.sortBoxs+":first");$destBox=f.parents(a.sortBoxs+":first");if($srcBox[0]!=$destBox[0]){$replaceItem=f.next();if($replaceItem.size()>0){$replaceItem.insertAfter(e)}}}e.insertAfter(f).show();f.remove();g.remove()},duration:300})},_createPlaceholder:function(d){return b("<"+d[0].nodeName+' class="sortDragPlaceholder"/>').css({width:d.outerWidth()+"px",height:d.outerHeight()+"px",marginTop:d.css("marginTop"),marginRight:d.css("marginRight"),marginBottom:d.css("marginBottom"),marginLeft:d.css("marginLeft")})},_getOverSortBox:function(e){var f=e.position();var g=f.top+(e.height()/2),d=f.left+(e.width()/2);return b(a.sortBoxs).filter(":visible").filter(function(){var j=b(this),h=j.position();return bee.isOver(g,d,h.top,h.left,j.height(),j.width())})}};b.fn.sortDrag=function(d){return this.each(function(){var f=b.extend({},a,d);var e=b(this);if(e.attr("selector")){f.selector=e.attr("selector")}e.find(f.items).each(function(h){var g=b(this),j=g;if(f.selector){j=g.find(f.selector).css({cursor:f.cursor})}j.mousedown(function(k){c.start(e,g,k,f);k.preventDefault()})})})}})(jQuery);(function(a){a.fn.widget=function(c){var b=a.extend({},a.fn.widget.defaults,c||{});var d=a(this);var e=function(){d.animate({opacity:0},function(){d.slideUp(function(){a(this).remove()})})};if(b.removable){a('<a href="#" class="remove">CLOSE</a>').mousedown(function(f){f.stopPropagation()}).click(function(){if(alertMsg){alertMsg.confirm("确定删除?",{okCall:function(){e()}})}else{if(confirm("确定删除?")){e()}}return false}).appendTo(a(b.headSelector,d))}if(b.collapsible){a('<a href="#" class="collapse">COLLAPSE</a>').mousedown(function(f){f.stopPropagation()}).toggle(function(){a(this).css({backgroundPosition:"0 -100px"});d.find(b.contentSelector).hide();return false},function(){a(this).css({backgroundPosition:""});d.find(b.contentSelector).show();return false}).prependTo(a(b.headSelector,d))}};a.fn.widget.defaults={headSelector:".widget-head",contentSelector:".widget-content",collapsible:true,removable:true}})(jQuery);